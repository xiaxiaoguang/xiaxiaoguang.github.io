<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://xiaxiaoguang.github.io</id>
    <title>å¤æ™“å…‰(loveJY)çš„åšå®¢</title>
    <updated>2020-03-19T04:07:29.270Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://xiaxiaoguang.github.io"/>
    <link rel="self" href="https://xiaxiaoguang.github.io/atom.xml"/>
    <subtitle>ä»è¦å‘ä¸‹æ‰æ ¹,å‘ä¸Šç»“æœ</subtitle>
    <logo>https://xiaxiaoguang.github.io/images/avatar.png</logo>
    <icon>https://xiaxiaoguang.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, å¤æ™“å…‰(loveJY)çš„åšå®¢</rights>
    <entry>
        <title type="html"><![CDATA[P3825 [NOI2017]æ¸¸æˆ]]></title>
        <id>https://xiaxiaoguang.github.io/post/p3825-noi2017you-xi/</id>
        <link href="https://xiaxiaoguang.github.io/post/p3825-noi2017you-xi/">
        </link>
        <updated>2020-03-19T03:45:33.000Z</updated>
        <content type="html"><![CDATA[<p>NOI2017D2T1</p>
<p>æ—©å°±å‹åœ¨æˆ‘çš„ä»»åŠ¡æ¸…å•é‡Œäº†...</p>
<p>å¦å¤–æ‰“ç®—å¼€å®Œåå¹´(å·¦å³)NOIç³»åˆ—çš„å‘å°±å»å¼€é›†è®­é˜Ÿä½œä¸šå’ŒYnoiå§</p>
<p>ä¸ºä»€ä¹ˆå‘¢?å› ä¸ºPKWUC2020æ•°æ®ç»“æ„å¤§èµ›,åšè¿‡Ynoiå’Œæ²¡åšè¿‡çš„è‚¯å®šä¸ä¸€æ ·</p>
<p>å° L è®¡åˆ’è¿›è¡Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>åœºæ¸¸æˆï¼Œæ¯åœºæ¸¸æˆä½¿ç”¨ä¸€å¼ åœ°å›¾ï¼Œå° L ä¼šé€‰æ‹©ä¸€è¾†è½¦åœ¨è¯¥åœ°å›¾ä¸Šå®Œæˆæ¸¸æˆã€‚</p>
<p>å° L çš„èµ›è½¦æœ‰ä¸‰è¾†ï¼Œåˆ†åˆ«ç”¨å¤§å†™å­—æ¯Aã€Bã€Cè¡¨ç¤ºã€‚åœ°å›¾ä¸€å…±æœ‰å››ç§ï¼Œåˆ†åˆ«ç”¨å°å†™å­—æ¯xã€aã€bã€cè¡¨ç¤ºã€‚å…¶ä¸­ï¼Œèµ›è½¦Aä¸é€‚åˆåœ¨åœ°å›¾aä¸Šä½¿ç”¨ï¼Œèµ›è½¦Bä¸é€‚åˆåœ¨åœ°å›¾bä¸Šä½¿ç”¨ï¼Œèµ›è½¦Cä¸é€‚åˆåœ¨åœ°å›¾cä¸Šä½¿ç”¨ï¼Œè€Œåœ°å›¾xåˆ™é€‚åˆæ‰€æœ‰èµ›è½¦å‚åŠ ã€‚é€‚åˆæ‰€æœ‰èµ›è½¦å‚åŠ çš„åœ°å›¾å¹¶ä¸å¤šè§ï¼Œæœ€å¤šåªä¼šæœ‰då¼ ã€‚</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>åœºæ¸¸æˆçš„åœ°å›¾å¯ä»¥ç”¨ä¸€ä¸ªå°å†™å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²æè¿°ã€‚ä¾‹å¦‚ï¼šS=xaabxcbcè¡¨ç¤ºå° L è®¡åˆ’è¿›è¡Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>8</mn></mrow><annotation encoding="application/x-tex">8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span>åœºæ¸¸æˆï¼Œå…¶ä¸­ç¬¬<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>åœºå’Œç¬¬<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span></span></span></span>åœºçš„åœ°å›¾ç±»å‹æ˜¯xï¼Œé€‚åˆæ‰€æœ‰èµ›è½¦ï¼Œç¬¬<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>åœºå’Œç¬¬<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span>åœºçš„åœ°å›¾æ˜¯aï¼Œä¸é€‚åˆèµ›è½¦Aï¼Œç¬¬<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span>åœºå’Œç¬¬<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>7</mn></mrow><annotation encoding="application/x-tex">7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span></span></span></span>åœºçš„åœ°å›¾æ˜¯bï¼Œä¸é€‚åˆèµ›è½¦Bï¼Œç¬¬<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>6</mn></mrow><annotation encoding="application/x-tex">6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span></span></span></span>åœºå’Œç¬¬<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>8</mn></mrow><annotation encoding="application/x-tex">8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span>åœºçš„åœ°å›¾æ˜¯cï¼Œä¸é€‚åˆèµ›è½¦Cã€‚</p>
<p>å° L å¯¹æ¸¸æˆæœ‰ä¸€äº›ç‰¹æ®Šçš„è¦æ±‚ï¼Œè¿™äº›è¦æ±‚å¯ä»¥ç”¨å››å…ƒç»„ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>i</mi><mo separator="true">,</mo><msub><mi>h</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><msub><mi>h</mi><mi>j</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(i, h_i, j, h_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>æ¥æè¿°ï¼Œè¡¨ç¤ºè‹¥åœ¨ç¬¬<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>åœºä½¿ç”¨å‹å·ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">h_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>â€‹çš„è½¦å­ï¼Œåˆ™ç¬¬<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span>åœºæ¸¸æˆè¦ä½¿ç”¨å‹å·ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">h_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>çš„è½¦å­ã€‚</p>
<p>ä½ èƒ½å¸®å° L é€‰æ‹©æ¯åœºæ¸¸æˆä½¿ç”¨çš„èµ›è½¦å—ï¼Ÿå¦‚æœæœ‰å¤šç§æ–¹æ¡ˆï¼Œè¾“å‡ºä»»æ„ä¸€ç§æ–¹æ¡ˆã€‚å¦‚æœæ— è§£ï¼Œè¾“å‡º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span>ï¼ˆä¸å«åŒå¼•å·ï¼‰ã€‚</p>
<p>é¦–å…ˆå…¶å®ä¸éš¾å‘ç°è¿™æ˜¯ä¸€ä¸ª2-SATé¢˜,å› ä¸ºä»–è¦æ±‚æ„é€ æ–¹æ¡ˆ,è€Œä¸”æœ‰ä¸€äº›<code>å¾ˆåƒ</code>2-SATçš„é™åˆ¶æ¡ä»¶,å¦å¤–èµ›è½¦åªæœ‰ä¸‰ç§,ä¸€ä¸ªåœ°å›¾é™åˆ¶äº†1ç§,æ‰€ä»¥åªæœ‰ä¸¤ç§å¯ç”¨çš„èµ›è½¦è¿™æ ·å­</p>
<p>æ‰€ä»¥æˆ‘ä»¬æƒ³å»æ‰xåœ°å›¾æ˜¯ä¸æ˜¯å°±æ˜¯ä¸ª2-SATè£¸é¢˜äº†å•Š,æ€ä¹ˆè§£å†³xçš„é™åˆ¶å‘¢,3-SATå¥½åƒæ˜¯æ²¡æœ‰ç¡®å®šæ€§å¤šé¡¹å¼ç®—æ³•çš„.....è€Œnåˆè¿™ä¹ˆå¤§</p>
<p>çœ‹ä¸€çœ¼xçš„æ•°é‡,<code>å°äºç­‰äº8</code>.....è¿™ä¸ªä¸æ˜¯æ˜æ‘†ç€è®©ä½ æšä¸¾å—?????</p>
<p>å¥½å§,æˆ‘æ‰¿è®¤,éš¾åº¦åœ¨äºå†™ä»£ç ,æ‰€ä»¥ä»”ç»†çœ‹çœ‹ä»£ç ,é‡Œé¢æœ‰å¾ˆä¸é”™çš„trick,æ¯”å¦‚åˆ©ç”¨tranå‡½æ•°æ‰¾åˆ°ç›¸å…³çš„ç‚¹</p>
<p>code:</p>
<pre><code class="language-cpp">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
using namespace std;

namespace fastIO {
#define BUF_SIZE (1&lt;&lt;19)
	static char buf[BUF_SIZE],*p1=buf+BUF_SIZE,*pend=buf+BUF_SIZE;

	inline char nc() {
		if(p1==pend) {
			p1=buf;
			pend=buf+fread(buf,1,BUF_SIZE,stdin);
		}
		return *p1++;
	}

	inline int read() {
		int x=0,f=1;
		char s=nc();
		for(; !isdigit(s); s=nc())if(s=='-')f=-1;
		for(; isdigit(s); s=nc())x=(x&lt;&lt;1)+(x&lt;&lt;3)+s-'0';
		//	printf(&quot;%d??\n&quot;,x);
		return x*f;
	}
	inline char get() {
		char c=nc();
		for(; !isalpha(c); c=nc());
		return c;
	}
	inline void _gets(char *s) {
		int tot=1;
		s[tot]=nc();
		for(; !isalpha(s[tot]); s[tot]=nc());
		for(; isalpha(s[tot]); s[tot]=nc())++tot;
		return ;
	}
}
using namespace fastIO;
const int MAXN=2e5+7;
int n,d,m,a1[MAXN],b1[MAXN],ccnt,nxt[MAXN],home[MAXN],to[MAXN],dfn[MAXN],low[MAXN],
    times,num,bel[MAXN],top,stk[MAXN],cyx[MAXN];
char s[MAXN],a2[MAXN],b2[MAXN],orz[MAXN];
bool ins[MAXN],flag;

inline void add(int u,int v) {
	nxt[++ccnt]=home[u];
	home[u]=ccnt;
	to[ccnt]=v;
}

inline int neg(int x) {
	return x&gt;n?x-n:x+n;
}

inline int tran(int x,char c) {
	if(s[x]=='a')return c=='B'?x:x+n;
	if(s[x]=='b'||s[x]=='c')return c=='A'?x:x+n;
	if(c=='C')return x+n;

	//è¯´å®è¯,è¿™ä¸ªtranå°±æ˜¯
	//å¦‚æœæ¬æ‰A,é‚£ä¹ˆå°±ç”¨Bä¸ºçœŸ,Cä¸ºå‡
	//æ¬æ‰b,åŒç†AçœŸCå‡
	//å•¥éƒ½æ²¡æ¬,ç¡¬ç‚¹xæ¬æ‰Aæˆ–è€…B
	//ä¸ºCä¸€å®šfalse,å¦åˆ™å¯èƒ½ä¸ºAæˆ–è€…B
	return x;
}

inline void tarjan(int u) {
	dfn[u]=low[u]=++times;
	ins[stk[++top]=u]=1;
	for(int i=home[u]; i; i=nxt[i]) {
		int v=to[i];
		if(!dfn[v]) {
			tarjan(v);
			low[u]=min(low[u],low[v]);
		} else if(ins[v]) {
			low[u]=min(low[u],dfn[v]);
		}
	}
	if(dfn[u]==low[u]) {
		int v;
		bel[u]=++num;
		ins[u]=0;
		while (v = stk[top--], v != u) bel[v] = num, ins[v] = 0;
	}
}

bool solve() {
	int i;
	ccnt=times=num=0;
	for(int i=1; i&lt;=(n&lt;&lt;1); ++i)bel[i]=home[i]=dfn[i]=0;
	for(int i=1; i&lt;=m; ++i) if(s[a1[i]]!='x'&amp;&amp;s[b1[i]]!='x') {
			if(a2[i]==s[a1[i]]-32)continue;//å‰å®³çš„æ˜¯,è¿™åœºæ¯”èµ›æ ¹æœ¬ä¸è®©ç”¨
			int u=tran(a1[i],a2[i]),v;
			if(b2[i]==s[b1[i]]-32) {
				add(u,neg(u));//å‰å®³çš„æ˜¯,å¦ä¸€è¾¹çš„æ¯”èµ›æ ¹æœ¬ä¸è®©ç”¨
				//æ‰€ä»¥ä½ ä¹Ÿä¸è®©ç”¨
				continue;
			}
			v=tran(b1[i],b2[i]);
			add(u,v);
			add(neg(v),neg(u));
			//ç›¸å½“äºå¦‚æœè¿™åœºæ¯”èµ›a1ä½ ç”¨a2,å¯æ¨å‡ºb1ç”¨b2
			//å¦åˆ™b1ä¸ç”¨b2,å¯æ¨å‡ºa1ä¸ç”¨a2
		} else {
			char o=s[a1[i]],p=s[b1[i]];
			int u,v,x=cyx[a1[i]],y=cyx[b1[i]];
			if(o=='x'&amp;&amp;p=='x') {
				if(a2[i]==orz[x])continue;//orzxæ˜¯ä¸èƒ½ç”¨çš„ä¹‹å‰dfsçš„
				u=tran(a1[i],a2[i]),v;
				if(b2[i]==orz[y]) {
					add(u,neg(u));
					continue;
				}
				v=tran(b1[i],b2[i]);
				add(u,v);
				add(neg(v),neg(u));
			} else if(o=='x'&amp;&amp;p!='x') {
				if(a2[i]==orz[x])continue;
				u=tran(a1[i],a2[i]),v;
				if(b2[i]==s[b1[i]]-32) {
					add(u,neg(u));
					continue;
				}
				v=tran(b1[i],b2[i]);
				add(u,v);
				add(neg(v),neg(u));
			} else {
				if(a2[i]==s[a1[i]]-32)continue;
				u=tran(a1[i],a2[i]),v;
				if(b2[i]==orz[y]) {
					add(u,neg(u));
					continue;
				}
				v=tran(b1[i],b2[i]);
				add(u,v);
				add(neg(v),neg(u));
			}
		}
	for(int i=1; i&lt;=(n&lt;&lt;1); ++i)if(!dfn[i])tarjan(i);
	for(int i=1; i&lt;=n; ++i)if(bel[i]==bel[i+n])return 0;//åˆ¤åˆæ³•?
	for(int i=1; i&lt;=n; ++i) {
		if(bel[i]&lt;bel[i+n]) {
			if(s[i]=='a')putchar('B');
			else if(s[i]=='b'||s[i]=='C')putchar('A');
			else if(orz[cyx[i]]=='A')putchar('B');
			else putchar('A');
		} else {
			if(s[i]=='a'||s[i]=='b')putchar('C');
			else if(s[i]=='c')putchar('B');
			else if(orz[cyx[i]]=='A')putchar('C');
			else putchar('B');
		}
	}
	return 1;
}

void dfs(int dep) {
	if(dep&gt;d) {
		if(!flag)flag=solve();
		if(flag)exit(0);
		return;
	}
	orz[dep]='A';
	dfs(dep+1);
	orz[dep]='B';
	dfs(dep+1);
	//åŸæ¥è¿™åªæ˜¯ä¸ªdfs
}

int main() {
//	freopen(&quot;test.in&quot;,&quot;r&quot;,stdin);
//	scanf(&quot;%d&quot;,&amp;n);
	n=read();
	int ___;
	___=read();
	_gets(s);
	m=read();
	register int i;
	for(i=1; i&lt;=n; ++i)if(s[i]=='x')cyx[i]=++d;
	for(i=1; i&lt;=m; ++i)a1[i]=read(),a2[i]=get(),b1[i]=read(),b2[i]=get();//printf(&quot;%c %c\n&quot;,a2[i],b2[i]);
	dfs(1);
	if(!flag)puts(&quot;-1&quot;);
	return 0;
}


</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[P1117 [NOI2016]ä¼˜ç§€çš„æ‹†åˆ† ]]></title>
        <id>https://xiaxiaoguang.github.io/post/p1117-noi2016you-xiu-de-chai-fen/</id>
        <link href="https://xiaxiaoguang.github.io/post/p1117-noi2016you-xiu-de-chai-fen/">
        </link>
        <updated>2020-03-17T23:58:15.000Z</updated>
        <content type="html"><![CDATA[<p>NOI2016D1T1</p>
<p>ä¹‹å‰æåˆ°å’•äº†,æ‰€ä»¥æ¥è¡¥ä¸Š</p>
<p>å…ˆè€ƒè™‘å–œé—»ä¹è§çš„95ptsç®—æ³•</p>
<p>æˆ‘ä»¬å¯ä»¥æšä¸¾ä¸€ä¸ªä¸­é—´ç‚¹,è®¡ç®—ä¸€ä¸‹ä»–å‘å‰èƒ½å½¢æˆçš„AAæ€»ä¸²æ•°,å‘åèƒ½å½¢æˆçš„BBä¸²çš„æ€»ä¸²æ•°</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>n</mi><mi>s</mi><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mi>a</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>âˆ—</mo><mi>b</mi><mo>[</mo><mi>i</mi><mo>]</mo></mrow></mrow><annotation encoding="application/x-tex">ans=\sum_{i=1}^n{a[i]*b[i]}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">b</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span></span></span></p>
<p>è¿™ä¸ª<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></p>
<p>ç„¶åå†è€ƒè™‘5ptsåšæ³•(</p>
<p>æˆ‘ä»¬è€ƒè™‘æšä¸¾ä¸€ä¸ªlen,ç„¶åè®¡ç®—æ¯ä¸ªç‚¹æ˜¯å¦æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º2lençš„AAä¸²çš„å¼€å¤´</p>
<p>é‚£æˆ‘ä»¬æ¯ä¸ªlenæ”¾ä¸€ä¸ªtag,è¿™æ ·æ¯ä¸ª2*lençš„ä¸²éƒ½è‡³å°‘ç»è¿‡2ä¸ªtag</p>
<p>æˆ‘ä»¬æƒ³,å¥½åƒè¦å¿«ä¸€ç‚¹å°±åªèƒ½æ±‚ä¸ªLCSæˆ–LCPå¿«ä¸€ç‚¹äº†......</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¯¹ç›¸é‚»ä¸¤ä¸ªtagæ±‚ä¸ªå‰ç¼€çš„LCS,è€Œåç¼€æ±‚ä¸€ä¸ªLCP,å¾—åˆ°ä¸‹å›¾</p>
<p>è“æ˜¯LCS,ç»¿æ˜¯LCP</p>
<figure data-type="image" tabindex="1"><img src="https://i.loli.net/2018/12/08/5c0b394224f12.png" alt="qwq" loading="lazy"></figure>
<p>æ­¤æ—¶ä¸€å®šæ²¡æœ‰ä¸€ä¸ªé•¿åº¦ä¸º2*lençš„AAä¸²ç»è¿‡,å› ä¸ºè¿™æœ€å¤§ç›¸ç­‰ä¸¤æ®µæ ¹æœ¬ä¸è¿ç»­,å…¶ä¸­é•¿åº¦ä¸ºAçš„ä¸€æ®µå’Œä¸‹ä¸€æ®µä¸€å®šæœ‰ä¸€ä¸ªä½ç½®ä¸åŒ</p>
<p>å†è€ƒè™‘å¦‚æœè¿™ä¸ªé•¿åº¦è¶³å¤Ÿé•¿å‘¢?</p>
<figure data-type="image" tabindex="2"><img src="https://i.loli.net/2018/12/08/5c0b3c8bcaa8c.png" alt="qwq" loading="lazy"></figure>
<p>é‚£ä¹ˆç²‰è‰²å¼€å¤´åˆ°çº¢è‰²ç»“å°¾ä¸€æ®µéƒ½å¯ä»¥ä½œä¸ºèµ·å§‹ç‚¹,è€Œç»¿è‰²ä¸€æ®µä¸­éƒ½å¯ä»¥ä½œä¸ºç»“å°¾ç‚¹</p>
<p>è¿™ä¸ªå°±æ˜¯ä¸€ä¸ªå·®åˆ†çš„æ ‡è®°äº†,æœ€åç»Ÿè®¡ç­”æ¡ˆå°±è¡Œäº†</p>
<p>code:</p>
<pre><code class="language-cpp">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;map&gt;
#define ll long long
using namespace std;
const int MAXN=6e4+3;
int n;
string s;
int res1[MAXN],res2[MAXN];

struct SAM {
	int c[MAXN],sa[MAXN],fa[MAXN],len[MAXN],tag[MAXN];
	int f[MAXN],son[MAXN],top[MAXN],siz[MAXN],dep[MAXN];
	int cnt,lst;
	map&lt;char,int&gt; ch[MAXN];
	struct edge {
		int to,nxt;
	} e[MAXN&lt;&lt;1];
	struct Gr {
		int ccnt,home[MAXN];
		struct edge {
			int to,nxt;
		} e[MAXN&lt;&lt;1];
		inline void add(int u,int v) {
			e[++ccnt]= {v,home[u]},home[u]=ccnt;
			e[++ccnt]= {u,home[v]},home[v]=ccnt;
		};
	} G;
	inline void ins(char c,int id) {
		int p=lst;
		int np=++cnt;
		//	printf(&quot;%d?%d\n&quot;,p,np);
		lst=np,tag[id]=np,len[np]=len[p]+1;
		for(; p&amp;&amp;!ch[p][c]; p=fa[p])ch[p][c]=np;
		if(!p)fa[np]=1;
		else {
			int q=ch[p][c];
			if(len[q]==len[p]+1)fa[np]=q;
			else {
				int nq=++cnt;
				len[nq]=len[p]+1,ch[nq]=ch[q];
				fa[nq]=fa[q],fa[q]=fa[np]=nq;
				for(; p&amp;&amp;ch[p][c]==q; p=fa[p]) ch[p][c]=nq;
			}
		}
	}
	void dfs(int u,int fa) {
		siz[u]=1;
		//printf(&quot;%d?%d\n&quot;,u,fa);
		for(int i=G.home[u]; i; i=G.e[i].nxt) {
			int v=G.e[i].to;
			if(v!=fa) {
				dep[v]=dep[u]+1;
				f[v]=u;
				dfs(v,u);
				siz[u]+=siz[v];
				son[u]=siz[v]&gt;siz[son[u]]?v:son[u];
			}
		}
	}
	void dfs(int u) {
		if(!top[u])top[u]=u;
		if(son[u])top[son[u]]=top[u],dfs(son[u]);
		for(int i=G.home[u]; i; i=G.e[i].nxt) {
			int v=G.e[i].to;
			if(v^f[u]&amp;&amp;v^son[u])dfs(v);
		}
	}
	inline void init() {
		for(int i=1; i&lt;=cnt; ++i)f[i]=fa[i],G.add(f[i],i);//fail
		dfs(1,0),dfs(1);
	}
	inline int query(int u,int v) {
		u=tag[u],v=tag[v];
		for(; top[u]^top[v]; u=f[top[u]]) {
			if(dep[top[u]]&lt;dep[top[v]])swap(u,v);
		}
		return len[dep[u]&lt;dep[v]?u:v];
	}
} samp,saml,zero;

inline int Min(int a,int b) {
	return a&lt;b?a:b;
}

int main() {
	//freopen(&quot;test.in&quot;,&quot;r&quot;,stdin);
	//ios::sync_with_stdio(false);
//	puts(&quot;qwq&quot;);
	int T;
	cin&gt;&gt;T;
//	cout&lt;&lt;T&lt;&lt;'\n';
	zero.cnt=zero.lst=1;
	while(T--&gt;0) {
		s.clear(),cin&gt;&gt;s,n=s.length();
		memset(res1,0,n+3&lt;&lt;3);
		memset(res2,0,n+3&lt;&lt;3);
		samp=zero,saml=zero;
		//puts(&quot;233&quot;);
		for(int i=0; i&lt;=n-1; ++i)samp.ins(s[i],i+1);
		//	puts(&quot;233&quot;);
		for(int i=n-1; i&gt;=0; --i)saml.ins(s[i],i+1);//å»ºåä¸²
		samp.init(),saml.init();
		for(int len=1; len&lt;=(n&gt;&gt;1); ++len) {
			for(int i=len; i+len-1&lt;=n; i+=len) {
				int j=i+len,hm=0,qm=0;
				if(j&lt;=n)hm=Min(saml.query(i,j),len);
				if(i&gt;1)qm=Min(samp.query(i-1,j-1),len-1);
				if(qm+hm&lt;len)continue;
				--res1[j+hm],++res1[j+hm-1-(qm+hm-len)];
				++res2[i-qm],--res2[i-qm+1+(qm+hm-len)];
                //å¯¹äºç»“å°¾å’Œå¼€å¤´åˆ†åˆ«å·®åˆ†
			}
		}
		for(int i=1; i&lt;=n; ++i)res1[i]+=res1[i-1],res2[i]+=res2[i-1];
        //æ±‚å‰ç¼€å’Œ
		ll ans=0;
		for(int i=2; i&lt;=n; ++i)ans+=1ll*res1[i-1]*res2[i];
		printf(&quot;%lld \n&quot;,ans);
	}
	return 0;
}

</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[P1721 [NOI2016]å›½ç‹é¥®æ°´è®°]]></title>
        <id>https://xiaxiaoguang.github.io/post/p1721-noi2016guo-wang-yin-shui-ji/</id>
        <link href="https://xiaxiaoguang.github.io/post/p1721-noi2016guo-wang-yin-shui-ji/">
        </link>
        <updated>2020-03-17T14:45:32.000Z</updated>
        <content type="html"><![CDATA[<p>NOI2016D2T2</p>
<p>è¿˜æœ‰ä¸€ä¸ªD1T1å’•ç€æ²¡å†™å‘¢qaq</p>
<p><code></code>äºæ˜¯ï¼Œè·³èš¤å›½åœ¨æ¯ä¸ªåŸå¸‚éƒ½ä¿®å»ºäº†ä¸€ä¸ªåœ†æŸ±å½¢æ°´ç®±ï¼Œè¿™äº›æ°´ç®±å®Œå…¨ç›¸åŒä¸”è¶³å¤Ÿé«˜ã€‚ä¸€ä¸ªé›¨å¤©åï¼Œç¬¬ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> ä¸ªåŸå¸‚æ”¶é›†åˆ°äº†é«˜åº¦ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">h_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„æ°´ã€‚ç”±äºåœ°ç†å’Œå¤©æ°”å› ç´ çš„å½±å“ï¼Œä»»ä½•ä¸¤ä¸ªä¸åŒåŸå¸‚æ”¶é›†åˆ°çš„æ°´é«˜åº¦äº’ä¸ç›¸åŒã€‚</p>
<p>è·³èš¤å›½ç‹ä¹Ÿè¯·æ¥èš‚èšå·¥åŒ å¸®å¿™ï¼Œå»ºç«‹äº†ä¸€ä¸ªåºå¤§çš„åœ°ä¸‹è¿é€šç³»ç»Ÿã€‚è·³èš¤å›½ç‹æ¯æ¬¡ä½¿ç”¨åœ°ä¸‹è¿é€šç³»ç»Ÿæ—¶ï¼Œå¯ä»¥æŒ‡å®šä»»æ„å¤šçš„åŸå¸‚ï¼Œå°†è¿™äº›åŸå¸‚çš„æ°´ç®±ç”¨åœ°ä¸‹è¿é€šç³»ç»Ÿè¿æ¥èµ·æ¥è¶³å¤Ÿé•¿çš„æ—¶é—´ä¹‹åï¼Œå†å°†åœ°ä¸‹è¿é€šç³»ç»Ÿå…³é—­ã€‚ç”±è¿é€šå™¨åŸç†ï¼Œè¿™äº›åŸå¸‚çš„æ°´ç®±ä¸­çš„æ°´åœ¨è¿™æ¬¡æ“ä½œåä¼šåˆ°è¾¾åŒä¸€é«˜åº¦ï¼Œå¹¶ä¸”è¿™ä¸€é«˜åº¦ç­‰äºæŒ‡å®šçš„å„æ°´ç®±é«˜åº¦çš„å¹³å‡å€¼ã€‚</p>
<p>ç”±äºåœ°ä¸‹è¿é€šç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œè·³èš¤å›½ç‹è‡³å¤šåªèƒ½ä½¿ç”¨<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span>æ¬¡åœ°ä¸‹è¿é€šç³»ç»Ÿã€‚</p>
<p>è·³èš¤å›½ç‹è¯·ä½ å‘Šè¯‰ä»–ï¼Œé¦–éƒ½ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> å·åŸå¸‚æ°´ç®±ä¸­çš„æ°´ä½æœ€é«˜èƒ½æœ‰å¤šé«˜ï¼Ÿ <code></code></p>
<p>é¦–å…ˆåˆ†æä¸€ä¸‹é¢˜ç›®çš„æ€§è´¨:</p>
<ol>
<li>é‚£äº›é«˜åº¦å°äºé¦–éƒ½çš„ç‚¹ä¸€å®šæ²¡ç”¨å¯ä»¥æ‰”æ‰</li>
<li>æˆ‘ä»¬åˆå¹¶ä¸€å®šå…ˆä½åé«˜!å› ä¸ºè®¾h_2&gt;h_1,è¦ä¹ˆå…ˆ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">h_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>=<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>2</mn><msub><mi>h</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>4</mn><msub><mi>h</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">1/2h_1+1/4h_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord">4</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&gt;å…ˆ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">h_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>=<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>4</mn><msub><mi>h</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>2</mn><msub><mi>h</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">1/4h_1+1/2h_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord">4</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>æœ€é«˜çš„å‰kä¸ªè¢«ä¼˜å…ˆåˆå¹¶<s>æ˜¾ç„¶</s></li>
</ol>
<p>æ‰€ä»¥æœ‰äº†è¿™ä¸ªåœ¨åŸæ•°ç»„ä¸Šæ’åºä¸€ä¸‹DPå°±æ²¡åæ•ˆæ€§äº†</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>è¡¨ç¤ºåˆ°ä½ç½®i,ä¹‹å‰è¿›è¡Œäº†jè½®</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mfrac><mrow><mi>f</mi><mo>[</mo><mi>k</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo>]</mo><mo>+</mo><msub><mi>s</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>s</mi><mi>k</mi></msub></mrow><mrow><mi>j</mi><mo>âˆ’</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mo>)</mo></mrow><annotation encoding="application/x-tex">dp[i][j]=max(\frac{f[k][j-1]+s_i-s_k}{j-k+1})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.30744em;vertical-align:-0.8804400000000001em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>ç›¸å½“äºåˆ’åˆ†ä¸€ä¸‹ç„¶åæ±‚å¹³å‡</p>
<p>è¿™ä¸ªå¼å­æ˜¾ç„¶å¯ä»¥æ–œç‡ä¼˜åŒ–,æ‰€æ±‚å°±æ˜¯ä¸€ä¸ªæœ€å¤§çš„æ–œç‡<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>s</mi><mi>k</mi></msub><mo>âˆ’</mo><mi>f</mi><mo>[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo>]</mo><mo>[</mo><mi>k</mi><mo>]</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">(k-1,s_k-f[i-1][k])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span>å’Œ(s_j,j)æ„æˆç›´çº¿æ–œç‡</p>
<p>åˆå› ä¸ºæ˜¯max,æ‰€ä»¥ç»´æŠ¤ä¸€ä¸ªä¸‹å‡¸å£³,ä¹Ÿä¸éš¾å‘ç°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">s_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>å•å¢</p>
<p>ç„¶è€Œè¿™é“é¢˜è¦è¾“å‡ºç­”æ¡ˆå3000ä½å°æ•°......æœ‰ä¸€ä¸ª700å¤šè¡Œçš„é«˜ç²¾åº¦å°æ•°ç±»,æˆ‘ä»¬ä¸å¯èƒ½ç”¨å¯¹å§</p>
<p>æˆ‘ä»¬éµå¾ªå¦‚ä¸‹è´ªå¿ƒåŸåˆ™</p>
<ul>
<li>èƒ½ä¸€æ¬¡ç”¨2ä¸ªå°±ä¸ç”¨å¤šä¸ª</li>
<li>å¦‚æœè¦åŠ å…¥åŸå¸‚è¿›è¿é€šå™¨,é‚£æ°´ä½ä¸€å®šè¦é«˜ä¸å½“å‰</li>
</ul>
<p>è¯æ˜1:æŠŠä¸€ä¸‹3ä¸ªåˆ†æˆä¸¤ä¸‹2ä¸ªæ˜¾ç„¶ä¼šæ›´å¥½å§</p>
<p>è¯æ˜2:å¦åˆ™çš„è¯ä¸ºä»€ä¹ˆåŠ ?å€’æµå—?</p>
<p>æœ‰äº†è¿™ä¸¤ä¸ªä¸œè¥¿,å°±ä¸éš¾æ„é€ äº†</p>
<p>code:</p>
<pre><code class="language-cpp">#include&lt;bits/stdc++.h&gt;
#define ll long long
using namespace std;
int N,n,m,p;
int h[8192],s[8192];
double f[16][8192];
int g[16][8192];
int a[400];
#define P pair&lt;int,double&gt;
double operator%(const P&amp;a,const P&amp;b) {
	return (b.second-a.second)/(b.first-a.first);
}
void div(int x) {
	ll q=0;
	for(int i=0; i&lt;=p; ++i) {
		q=q*1000000000+a[i];
		a[i]=q/x;
		q%=x;
	}
}

int main() {
	scanf(&quot;%d%d%d&quot;,&amp;N,&amp;m,&amp;p);
	p=p/9+1;
	scanf(&quot;%d&quot;,&amp;h[n=1]);
	for(int i=2; i&lt;=N; ++i) {
		int t;
		scanf(&quot;%d&quot;,&amp;t);
		if(h[1]&lt;t)h[++n]=t;
		//ç›´æ¥å¼ƒæ‰
	}
	sort(h+1,h+n+1);
	if(m&gt;n)m=n;
	for(int i=1; i&lt;=n; ++i)f[0][i]=h[1],s[i]=s[i-1]+h[i];
	//sæ˜¯å‰ç¼€å’Œ
	int l=14;//ä½ é—®è¿™ä¸€æ‰‹æœ‰ä»€ä¹ˆç”¨?æˆ‘åªèƒ½å‘Šè¯‰ä½ è¿™æ˜¯ç„å­¦ä¼˜åŒ–,è¿14æ¬¡å°±æœ€ä¼˜.....
	if(l&gt;m)l=m;
	for(int i=1; i&lt;=l; ++i) {
		static P q[8024];//é˜Ÿåˆ—
//		memset(q,0,sizeof(q));

		for(int j=2,l=1,r=0; j&lt;=n; ++j) {
			P c=P(j-2,s[j-1]-f[i-1][j-1]);
			//ç»´æŠ¤(k-1,s[k]-f[i-1][k])
			for(; l&lt;r&amp;&amp;(q[r-1]%q[r])&gt;(q[r]%c); r--);//ç›˜ä¸€ä¸‹æ–œç‡
			q[++r]=c;//æŠŠk-1åŠ å…¥å†³ç­–åºåˆ—
			P t=P(j,s[j]);//s[j]éšjçš„å•è°ƒé€’å¢è€Œé€’å¢
			for(; l&lt;r&amp;&amp;(q[l]%t)&lt;(q[l+1]%t); ++l);
			g[i][j]=q[l].first+1;
			//	printf(&quot;%d\n&quot;,g[i][j]);
			//è®°å½•ä¸€ä¸‹è½¬ç§»æœ€ä¼˜å†³ç­–ç‚¹,æ³¨æ„firstä»£è¡¨å“ªä¸ªæ•° 
			f[i][j]=(q[l]%t);
		}
	}
///	puts(&quot;QWQ&quot;);
	int b[16];

	b[l]=n-(m-l);
	//è¿™ä¸ªç­‰äºæœ€åå­˜æ´»æ•°?
	//å½“n=m,æˆ‘ä»¬è¿äº†læ¬¡
	for(int i=l; i; i--)b[i-1]=g[i][b[i]];//æ‰¾åˆ°è¿™äº›æ¯æ¬¡é€‰æ‹©çš„åºåˆ—ç‚¹ 
	a[0]=h[1];
	for(int i=1; i&lt;=l; ++i)a[0]+=s[b[i]]-s[b[i-1]],div(b[i]-b[i-1]+1);//læ¬¡è¿ä¸€å®šå…ˆè¿å¤§çš„å†å°çš„.å› ä¸ºhå·²ç»æ’åºäº†...
	for(int i=b[l]+1; i&lt;=n; ++i)a[0]+=h[i],div(2);//æœ‰å¤šä½™çš„,å¯ä»¥è€ƒè™‘å†å‹‡ä¸¤ä¸ªç»ƒä¸€ä¸‹
	printf(&quot;%d.&quot;,a[0]);
	for(int i=1; i&lt;=p; ++i)printf(&quot;%09d&quot;,a[i]);
	return 0;
}


</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[åº†ç¥åšæ–‡è¿‡ç™¾!]]></title>
        <id>https://xiaxiaoguang.github.io/post/qing-zhu-bo-wen-guo-bai/</id>
        <link href="https://xiaxiaoguang.github.io/post/qing-zhu-bo-wen-guo-bai/">
        </link>
        <updated>2020-03-17T03:46:30.000Z</updated>
        <content type="html"><![CDATA[<p>ğŸ˜ƒğŸ‰<br>
å½“ç„¶,è¿™é‡Œä»…æœ‰12ç¯‡,æ´›è°·å“ªé‡Œè¿˜æœ‰89ç¯‡,åªæ˜¯æ²¡æœ‰æ¬è¿‡æ¥è€Œå·²,è¿‡ç™¾å·²æ˜¯äº‹å®</p>
<p>è®°å½•äº2020.3.17,covid19æ—¶æœŸ</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[P1587 [NOI2016]å¾ªç¯ä¹‹ç¾]]></title>
        <id>https://xiaxiaoguang.github.io/post/p1587-noi2016xun-huan-zhi-mei/</id>
        <link href="https://xiaxiaoguang.github.io/post/p1587-noi2016xun-huan-zhi-mei/">
        </link>
        <updated>2020-03-17T01:49:41.000Z</updated>
        <content type="html"><![CDATA[<p>NOI2016D1T3<s>åæ­£æ˜¯Tå‡ éƒ½æ— æ‰€è°“äº†å•Š</s></p>
<p>é¢˜æ„:æ±‚<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>y</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mfrac><mi>x</mi><mi>y</mi></mfrac></mrow><annotation encoding="application/x-tex">\sum_{x=1}^n\sum_{y=1}^m\frac{x}{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2854em;vertical-align:-0.481108em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><br>
â€‹åœ¨<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span>è¿›åˆ¶ä¸‹èƒ½è¡¨ç¤ºæˆå¾ªç¯èŠ‚ä»ç¬¬ä¸€ä½å°æ•°å¼€å§‹çš„æ— é™å¾ªç¯å°æ•°æˆ–æ•´æ•°çš„æœ€ç®€åˆ†æ•°ä¸ªæ•°</p>
<p>é¦–å…ˆç¡¬ç‚¹å¾ªç¯èŠ‚é•¿åº¦l</p>
<p>æ‰€ä»¥$$[\frac{xk^l}{y}]=[\frac{x}{y}]$$<br>
[]è¡¨ç¤ºä¸€ä¸ªæ•°å°æ•°éƒ¨åˆ†</p>
<p>è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢?ç›¸å½“äºåœ¨Kè¿›åˆ¶ä¸‹æŠŠå°æ•°éƒ¨åˆ†æå‰lä½ä¹‹åçš„æ•°çš„å°æ•°éƒ¨åˆ†è¿˜æ˜¯ç›¸åŒçš„.å¯ä»¥ç»“åˆåè¿›åˆ¶<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><msup><mn>0</mn><mi>l</mi></msup></mrow><annotation encoding="application/x-tex">10^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span></span></span></span>ç†è§£</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>x</mi><mo>âˆ—</mo><msup><mi>k</mi><mi>l</mi></msup></mrow><mi>y</mi></mfrac><mo>âˆ’</mo><mo>âŒŠ</mo><mfrac><mrow><mi>x</mi><mo>âˆ—</mo><msup><mi>k</mi><mi>l</mi></msup></mrow><mi>y</mi></mfrac><mo>âŒ‹</mo><mo>=</mo><mfrac><mi>x</mi><mi>y</mi></mfrac><mo>âˆ’</mo><mo>âŒŠ</mo><mfrac><mi>x</mi><mi>y</mi></mfrac><mo>âŒ‹</mo></mrow><annotation encoding="application/x-tex">\frac{x*k^l}{y}-\lfloor {\frac{x*k^l}{y}} \rfloor=\frac{x}{y}-\lfloor {\frac{x}{y}} \rfloor
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.406548em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.526108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.406548em;vertical-align:-0.8804400000000001em;"></span><span class="mopen">âŒŠ</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.526108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mclose">âŒ‹</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.9880000000000002em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.9880000000000002em;vertical-align:-0.8804400000000001em;"></span><span class="mopen">âŒŠ</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mclose">âŒ‹</span></span></span></span></span></p>
<p>åŒæ—¶ä¹˜yå¹¶å¯¹yå–æ¨¡</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>âˆ—</mo><msup><mi>k</mi><mi>l</mi></msup><mo>â‰¡</mo><mi>x</mi><mo>(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">x*k^l \equiv x(mod y)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8991079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span></p>
<p>é¢˜ç›®åªè€ƒè™‘æœ€ç®€åˆ†æ•°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">(x,y)=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>k</mi><mi>l</mi></msup><mo>â‰¡</mo><mn>1</mn><mo>(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">k^l \equiv 1(mod y)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8991079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span></p>
<p>è¿™ä¸ªæ˜¾ç„¶å°±æ˜¯kå’Œyäº’è´¨äº†</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>n</mi><mi>s</mi><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo>[</mo><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo><mo>=</mo><mo>=</mo><mn>1</mn><mo>]</mo><mo>[</mo><mo>(</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi><mo>)</mo><mo>=</mo><mo>=</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">Ans=\sum_{i=1}^{m}\sum_{j=1}^m[(i,j)==1][(j,k)==1]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mopen">[</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></p>
<p>è¿™ä¸ªç¥ä»™ä¸œè¥¿å‰ä¸€ä¸ª[]å’Œåä¸€ä¸ª[]éƒ½æ˜¯å¯ä»¥å¤„ç†çš„,å¯ä»¥çœ‹<br>
<a href="https://www.luogu.com.cn/problemnew/solution/P1587">é¢˜è§£åŒºç¬¬ä¸€ç¯‡ç¥ä»™çš„</a></p>
<p>è¿™é‡Œå¤„ç†ç¬¬ä¸€ä¸ª,å°±æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo><mo>=</mo><mo>=</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">[(i,j)==1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></p>
<p>äº¤æ¢æ±‚å’Œé¡ºåº</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo>[</mo><mo>(</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi><mo>)</mo><mo>=</mo><mo>=</mo><mn>1</mn><mo>]</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo>[</mo><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo><mo>=</mo><mo>=</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">=\sum_{j=1}^m[(j,k)==1]\sum_{i=1}^{m}[(i,j)==1]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mopen">[</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">[</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></p>
<p>è«æ¯”ä¹Œæ–¯åæ¼”å±•å¼€</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo>[</mo><mo>(</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi><mo>)</mo><mo>=</mo><mo>=</mo><mn>1</mn><mo>]</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munder><mo>âˆ‘</mo><mrow><mi>d</mi><mi mathvariant="normal">âˆ£</mi><mi>i</mi><mo separator="true">,</mo><mi>d</mi><mi mathvariant="normal">âˆ£</mi><mi>j</mi></mrow></munder><mi>Î¼</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">=\sum_{j=1}^m[(j,k)==1]\sum_{i=1}^{m}\sum_{d|i,d|j}\mu{d}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mopen">[</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.167402em;vertical-align:-1.516005em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">d</span><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mord"><span class="mord mathdefault">d</span></span></span></span></span></span></p>
<p>då†åˆ°æœ€å‰é¢</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>d</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>Î¼</mi><mi>d</mi><munderover><mo>âˆ‘</mo><mrow><mi>d</mi><mi mathvariant="normal">âˆ£</mi><mi>i</mi></mrow><mi>n</mi></munderover><munderover><mo>âˆ‘</mo><mrow><mi>d</mi><mi mathvariant="normal">âˆ£</mi><mi>j</mi></mrow><mi>m</mi></munderover><mo>[</mo><mo>(</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi><mo>)</mo><mo>=</mo><mo>=</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">=\sum_{d=1}^n\mu{d}\sum_{d|i}^n\sum_{d|j}^m[(j,k)==1]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.1674020000000005em;vertical-align:-1.5160049999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mord"><span class="mord mathdefault">d</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.8089950000000001em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5160049999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.8089950000000001em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5160049999999998em;"><span></span></span></span></span></span><span class="mopen">[</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></p>
<p>æŠŠæšä¸¾ä»–çš„å€æ•°å˜æˆæšä¸¾ä»–çš„å‡ å€</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>d</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>[</mo><mi>d</mi><mi mathvariant="normal">âŠ¥</mi><mi>k</mi><mo>]</mo><mi>Î¼</mi><mi>d</mi><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mi>d</mi></mrow></munderover><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>m</mi><mi mathvariant="normal">/</mi><mi>d</mi></mrow></munderover><mo>[</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo>(</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi><mo>)</mo><mo>=</mo><mo>=</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">=\sum_{d=1}^n[d âŠ¥ k]\mu{d}\sum_{i=1}^{n/d}\sum_{j=1}^{m/d}[gcd(j,k)==1]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.3747820000000006em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault">d</span><span class="mord">âŠ¥</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mord mathdefault">Î¼</span><span class="mord"><span class="mord mathdefault">d</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9610050000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.386005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mtight">/</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9610050000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.386005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mtight">/</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></p>
<p>(å› ä¸ºj,kè¦äº’è´¨d,kè¦å…ˆäº’è´¨æ‰è¡Œ)<br>
æœ‰ä¸ªå¾ªç¯æ²¡ç”¨</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>d</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>[</mo><mi>d</mi><mi mathvariant="normal">âŠ¥</mi><mi>k</mi><mo>]</mo><mi>Î¼</mi><mi>d</mi><mo>âŒŠ</mo><mfrac><mi>n</mi><mi>d</mi></mfrac><mo>âŒ‹</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>m</mi><mi mathvariant="normal">/</mi><mi>d</mi></mrow></munderover><mo>[</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo>(</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi><mo>)</mo><mo>=</mo><mo>=</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">=\sum_{d=1}^n[d âŠ¥ k]\mu{d}\lfloor\frac{n}{d}\rfloor\sum_{j=1}^{m/d}[gcd(j,k)==1]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.3747820000000006em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault">d</span><span class="mord">âŠ¥</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mord mathdefault">Î¼</span><span class="mord"><span class="mord mathdefault">d</span></span><span class="mopen">âŒŠ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">d</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">âŒ‹</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9610050000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.386005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mtight">/</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></p>
<p>å¥½æˆ‘ä»¬å¯ä»¥åˆ†æˆä¸¤ä¸ªäº†</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>x</mi></munderover><mo>[</mo><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>k</mi><mo>)</mo><mo>=</mo><mo>=</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">f(x)=\sum_{i=1}^x[(i,k)==1]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">[</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>x</mi></munderover><mo>[</mo><mi>i</mi><mi mathvariant="normal">âŠ¥</mi><mi>k</mi><mo>]</mo><mi>Î¼</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">S(x)=\sum_{i=1}^x[iâŠ¥k]\mu{i}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mord">âŠ¥</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mord mathdefault">Î¼</span><span class="mord"><span class="mord mathdefault">i</span></span></span></span></span></span></p>
<p>è€ƒè™‘f(x)æ€ä¹ˆåš</p>
<p>ç›¸å½“äºæ¯kæ®µä»–çš„ç­”æ¡ˆæ˜¯ä¸€æ ·çš„</p>
<p>æ‰€ä»¥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mo>âŒŠ</mo><mfrac><mi>x</mi><mi>k</mi></mfrac><mo>âŒ‹</mo><mi>f</mi><mo>(</mo><mi>k</mi><mo>)</mo><mo>+</mo><mi>f</mi><mo>(</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">f(x)=\lfloor\frac{x}{k}\rfloor f(k)+f(x%k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mopen">âŒŠ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">âŒ‹</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span></span></span></span><br>
k&lt;=2000,åªéœ€è¦é¢„å¤„ç†å°±å¯ä»¥O1äº†</p>
<p>é—®é¢˜åœ¨äºS(x)</p>
<p>è®¾<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>k</mi><mo>)</mo><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>x</mi></msubsup><mo>[</mo><mi>i</mi><mi mathvariant="normal">âŠ¥</mi><mi>k</mi><mo>]</mo><mi>Î¼</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">S(x,k)=\sum_{i=1}^x[iâŠ¥k]\mu{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mord">âŠ¥</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mord mathdefault">Î¼</span><span class="mord"><span class="mord mathdefault">i</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>x</mi></munderover><mi>Î¼</mi><mi>i</mi><mo>[</mo><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>k</mi><mo>)</mo><mo>=</mo><mo>=</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">=\sum_{i=1}^x\mu{i}[(i,k)==1]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mord"><span class="mord mathdefault">i</span></span><span class="mopen">[</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>x</mi></munderover><mi>Î¼</mi><mi>i</mi><munder><mo>âˆ‘</mo><mrow><mi>d</mi><mi mathvariant="normal">âˆ£</mi><mi>i</mi><mo separator="true">,</mo><mi>d</mi><mi mathvariant="normal">âˆ£</mi><mi>k</mi></mrow></munder><mi>Î¼</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">=\sum_{i=1}^x\mu{i}\sum_{d|i,d|k}\mu{d}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.167402em;vertical-align:-1.516005em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mord"><span class="mord mathdefault">i</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">d</span><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mord"><span class="mord mathdefault">d</span></span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>d</mi><mi mathvariant="normal">âˆ£</mi><mi>k</mi></mrow></munder><mi>Î¼</mi><mi>d</mi><munder><mo>âˆ‘</mo><mrow><mi>d</mi><mi mathvariant="normal">âˆ£</mi><mi>i</mi></mrow></munder><mi>Î¼</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">=\sum_{d|k}\mu{d}\sum_{d|i}\mu{i}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.5660100000000003em;vertical-align:-1.516005em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mord"><span class="mord mathdefault">d</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mord"><span class="mord mathdefault">i</span></span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>d</mi><mi mathvariant="normal">âˆ£</mi><mi>k</mi></mrow></munder><mi>Î¼</mi><mi>d</mi><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>x</mi><mi mathvariant="normal">/</mi><mi>d</mi></mrow></munderover><mi>Î¼</mi><mrow><mi>i</mi><mi>d</mi></mrow></mrow><annotation encoding="application/x-tex">=\sum_{d|k}\mu{d}\sum_{i=1}^{x/d}\mu{id}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.4770100000000004em;vertical-align:-1.516005em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mord"><span class="mord mathdefault">d</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9610050000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.386005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mord mtight">/</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mord"><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>d</mi><mo>)</mo><mo>!</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">(i,d)!=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mclose">)</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>åˆ™<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î¼</mi><mo>(</mo><mi>i</mi><mi>d</mi><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu(id)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">Î¼</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>ä¸ä¼šå¯¹ç­”æ¡ˆé€ æˆå½±å“</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>âˆ´</mo><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>d</mi><mo>)</mo><mo>=</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\therefore  (i,d)==1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69224em;vertical-align:0em;"></span><span class="mrel amsrm">âˆ´</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>d</mi><mi mathvariant="normal">âˆ£</mi><mi>k</mi></mrow></munder><mi>Î¼</mi><mo>(</mo><mi>d</mi><mo>)</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mi mathvariant="normal">âŠ¥</mi><mi>d</mi></mrow><mrow><mi>x</mi><mi mathvariant="normal">/</mi><mi>d</mi></mrow></munderover><mi>Î¼</mi><mo>(</mo><mi>i</mi><mo>)</mo><mi>Î¼</mi><mo>(</mo><mi>d</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">=\sum_{d|k}\mu(d)\sum_{i=1,iâŠ¥d}^{x/d}\mu(i)\mu(d)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.47701em;vertical-align:-1.516005em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.961005em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span><span class="mord mtight">âŠ¥</span><span class="mord mathdefault mtight">d</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.386005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mord mtight">/</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.438221em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mord mathdefault">Î¼</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mclose">)</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>d</mi><mi mathvariant="normal">âˆ£</mi><mi>k</mi></mrow></munder><mi>Î¼</mi><mo>(</mo><mi>d</mi><msup><mo>)</mo><mn>2</mn></msup><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mi mathvariant="normal">âŠ¥</mi><mi>d</mi></mrow><mrow><mi>x</mi><mi mathvariant="normal">/</mi><mi>d</mi></mrow></munderover><mi>Î¼</mi><mo>(</mo><mi>i</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">=\sum_{d|k}\mu(d)^2\sum_{i=1,iâŠ¥d}^{x/d}\mu(i)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.47701em;vertical-align:-1.516005em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.961005em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span><span class="mord mtight">âŠ¥</span><span class="mord mathdefault mtight">d</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.386005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mord mtight">/</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.438221em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>d</mi><mi mathvariant="normal">âˆ£</mi><mi>k</mi></mrow></munder><mi>Î¼</mi><mo>(</mo><mi>d</mi><msup><mo>)</mo><mn>2</mn></msup><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>x</mi><mi mathvariant="normal">/</mi><mi>d</mi></mrow></munderover><mi>Î¼</mi><mo>(</mo><mi>i</mi><mo>)</mo><mo>[</mo><mi>i</mi><mi mathvariant="normal">âŠ¥</mi><mi>d</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">=\sum_{d|k}\mu(d)^2\sum_{i=1}^{x/d}\mu(i)[iâŠ¥d]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.4770100000000004em;vertical-align:-1.516005em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9610050000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.386005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mord mtight">/</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mord">âŠ¥</span><span class="mord mathdefault">d</span><span class="mclose">]</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>d</mi><mi mathvariant="normal">âˆ£</mi><mi>k</mi></mrow></munder><mi>Î¼</mi><mo>(</mo><mi>d</mi><msup><mo>)</mo><mn>2</mn></msup><mi>S</mi><mo>(</mo><mo>âŒŠ</mo><mfrac><mi>x</mi><mi>d</mi></mfrac><mo>âŒ‹</mo><mo separator="true">,</mo><mi>d</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">=\sum_{d|k}\mu(d)^2S(\lfloor \frac{x}{d} \rfloor,d)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.623565em;vertical-align:-1.516005em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mtight">âˆ£</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mopen">âŒŠ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">d</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">âŒ‹</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mclose">)</span></span></span></span></span></p>
<p>ç›´æ¥æ¨¡æ‹Ÿè¿™ä¸ªå¼å­æ˜¯é”™çš„,ä¸æ˜¯Tæ‰,æ˜¯k=1æ—¶æ— æ³•ç»§ç»­é€’å½’</p>
<p>äºæ˜¯æˆ‘ä»¬æŠŠk=1å¸¦å…¥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mn>1</mn><mo>)</mo><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>x</mi></msubsup><mi>Î¼</mi><mo>(</mo><mi>i</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">S(x,1)=\sum_{i=1}^x\mu(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span></p>
<p>è¿™ä¸ªä¸æ˜¯æœæ•™ç­›?</p>
<p>æ‰€ä»¥åšå®Œäº†a</p>
<p>å¤æ‚åº¦æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mo>(</mo><mi>k</mi><mi mathvariant="normal">çš„</mi><mi mathvariant="normal">è´¨</mi><mi mathvariant="normal">å› </mi><mi mathvariant="normal">å­</mi><mi mathvariant="normal">ä¸ª</mi><mi mathvariant="normal">æ•°</mi><mo>)</mo><msqrt><mi>n</mi></msqrt><mo>+</mo><msup><mi>n</mi><mfrac><mn>2</mn><mn>3</mn></mfrac></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O((kçš„è´¨å› å­ä¸ªæ•°)\sqrt n+n^{\frac{2}{3}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.05028em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">è´¨</span><span class="mord cjk_fallback">å› </span><span class="mord cjk_fallback">å­</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">æ•°</span><span class="mclose">)</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8002800000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="padding-left:0.833em;">n</span></span><span style="top:-2.76028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.23972em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.20402em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9540200000000001em;"><span style="top:-3.363em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443142857142858em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>code:</p>
<pre><code class="language-cpp">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;cmath&gt;
#include&lt;algorithm&gt;
#include&lt;set&gt;
#include&lt;map&gt;
#include&lt;vector&gt;
#include&lt;queue&gt;
using namespace std;
const int MAXN=1e7;
#define ll long long
namespace fastIO {
#define BUF_SIZE (1&lt;&lt;19)
	static char buf[BUF_SIZE],*p1=buf+BUF_SIZE,*pend=buf+BUF_SIZE;
	inline char nc() {
		if(p1==pend) {
			p1=buf;
			pend=buf+fread(buf,1,BUF_SIZE,stdin);
		}
		return *p1++;
	}
	inline int read() {
		int x=0,f=1;
		register char s=nc();
		for(; !isdigit(s); s=nc())if(s=='-')f=-1;
		for(; isdigit(s); s=nc())x=(x&lt;&lt;1)+(x&lt;&lt;3)+s-'0';
		return x*f;
	}
}
using namespace fastIO;
int n,K,N,m;
bool pp[5000];
int F[5000];
bool zs[MAXN+10];
int tot,pri[MAXN+1],mu[MAXN+1],smu[MAXN+2];
map&lt;pair&lt;int,int&gt;,int&gt; M;
void pre() {
	for(int i=1; i&lt;=K; ++i)pp[i]=__gcd(i,K)==1;
	for(int i=1; i&lt;=K; ++i)F[i]=F[i-1]+pp[i];
	//Fæ•°ç»„é¢„å¤„ç†
	zs[1]=1;
	mu[1]=1;
	for(int i=2; i&lt;=N; ++i) {
		if(!zs[i])pri[++tot]=i,mu[i]=-1;
		for(int j=1; j&lt;=tot&amp;&amp;i*pri[j]&lt;=N; ++j) {
			zs[i*pri[j]]=1;
			if(i%pri[j])mu[i*pri[j]]=-mu[i];
			else break;
		}
	}
	//æœæ•™ç­›é¢„å¤„ç†
	for(int i=1; i&lt;=N; ++i)smu[i]=smu[i-1]+mu[i];
}

int SF(int x) {
	return (x/K)*F[K]+F[x%K];
	//O1ç®—å‡ºFæ•°ç»„
}

int SS(int x,int k) {
	if((k==1&amp;&amp;x&lt;=N)||(!x))return smu[x];
	//å·²ç»è¿›å…¥æœæ•™ç­›äº†
	if(M[make_pair(x,k)])return M[make_pair(x,k)];
	//è®°æœè¿”å›
	int ret=0;
	if(k==1) {
		ret=1;//\mu*1=Ï… 
		for(int i=2,j; i&lt;=x; i=j+1) {
			j=x/(x/i);
			ret-=(j-i+1)*SS(x/i,1);
			//æ•´é™¤åˆ†å—æœæ•™ç­›
		}
		//æ•´é™¤åˆ†å—
	} else {
		for(int i=1; i*i&lt;=k; ++i) {
			if(k%i==0) {
				if(mu[i])ret+=SS(x/i,i);
				if(i*i!=k&amp;&amp;mu[k/i])ret+=SS(x/(k/i),k/i);
			} 
			//æ ¹å·næšä¸¾çº¦æ•° 
		}
	}
	return M[make_pair(x,k)]=ret;
}

int main() {
	scanf(&quot;%d%d%d&quot;,&amp;n,&amp;m,&amp;K);
	N=MAXN;
	pre();
	ll ans=0,lt=0,nw=0;
	for(int i=1,j; i&lt;=min(n,m); i=j+1) {
		j=min(n/(n/i),m/(m/i));
		nw=SS(j,K);
		ans+=1ll*(nw-lt)*(n/i)*SF(m/i);//åªæœ‰n/iå•ç‹¬ç®—äº† 
		lt=nw;
		//æ•´é™¤åˆ†å—
	}
	printf(&quot;%lld\n&quot;,ans);
	return 0;
}

</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[P1712 [NOI2016]åŒºé—´]]></title>
        <id>https://xiaxiaoguang.github.io/post/p1712-noi2016qu-jian/</id>
        <link href="https://xiaxiaoguang.github.io/post/p1712-noi2016qu-jian/">
        </link>
        <updated>2020-03-16T14:57:10.000Z</updated>
        <content type="html"><![CDATA[<p>NOI2016D1T1</p>
<p>å…¶å®ç›¸å½“ç®€å•,æˆ‘ä¸€å¼€å§‹æƒ³äº†ä¸€ä¸ªåœ¨åºåˆ—ä¸Šæš´åŠ›ç”¨å¹³è¡¡æ ‘ç»´æŠ¤å·®åˆ†çš„åšæ³•,å°±æ˜¯å¼€ä¸‰ä¸ªå¹³è¡¡æ ‘?,å…¶ä¸­ä¸­é—´ä¸€ä¸ªä¿æŒå¤§å°ä¸ºM,å°±æ˜¯ç»´æŠ¤ç­”æ¡ˆé›†åˆ,å…¶ä»–ä¸¤ä¸ªä¸€ä¸ªç»´æŠ¤æ¯”ç­”æ¡ˆé›†åˆä¸­æœ€å¤§å€¼å¤§çš„å€¼,ä¸€ä¸ªæ¯”æœ€å°å€¼å°çš„å€¼,é‚£ä¹ˆæ‰“å¥½å·®åˆ†æ ‡è®°ååŠ å…¥åˆ é™¤å¯¹åº”ä¹Ÿå¾ˆç®€å•,ä½†æ˜¯å¾ˆå®¹æ˜“Tæ‰</p>
<p>æˆ‘ä»¬çœ‹åˆ°æœ€å¤§å€¼-æœ€å°å€¼æœ€å¤§è¿™ä¸ªæ˜¾ç„¶å°±æ˜¯å°ºå–,å°ºå–è¿™ä¸ªæœ€å¤§å€¼-æœ€å°å€¼,é‚£ä¹ˆæ˜¾ç„¶æ˜¯åœ¨å€¼åŸŸä¸Šå°ºå–,æ‰€ä»¥æˆ‘ä»¬è¦æŒ‰ç…§æ¯æ¡çº¿æ®µçš„é•¿åº¦æ’åºå°ºå–</p>
<p>æœ‰äº†è¿™ä¸ªæƒ³æ³•,å¦‚ä½•æ»¡è¶³æ°å¥½Mçš„é™åˆ¶å‘¢?çº¿æ®µæ ‘åŒºé—´åŠ çº¿æ®µ,å¦‚æœå…¨å±€æœ€å¤§å€¼&gt;=mè¯´æ˜æ­¤æ—¶åˆæ³•äº†,ä¸éš¾çœ‹å‡ºå°ºå–æ³•çš„åˆ çº¿æ®µåœ¨çº¿æ®µæ ‘ä¸Šä¹Ÿå¾ˆå¥½ç»´æŠ¤,è¿™æ ·å°±å¯ä»¥åšåˆ°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">O(nlogn)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>äº†</p>
<p>code:<br>
<s>è™½ç„¶ä¸‘ä½†æ˜¯æ˜¯æœ¬äººå†™çš„</s></p>
<pre><code class="language-cpp">//From:Dawn light
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;cmath&gt;
#include&lt;vector&gt;
#define ll long long
using namespace std;
const int MAXN=6e5+7;
vector&lt;int&gt; v;
int n,m;
struct node {
	int mx,ad;
} tr[MAXN&lt;&lt;2];

struct rec {
	int l,r,len;
	bool operator&lt;(const rec &amp;x)const {
		return len&lt;x.len;
	}
} a[MAXN];

#define mid ((x+y)&gt;&gt;1)
#define ls (k&lt;&lt;1)
#define rs (k&lt;&lt;1|1)

inline void pushup(int k) {
	tr[k].mx=max(tr[ls].mx,tr[rs].mx);
}

inline void pushdown(int k) {
	if(tr[k].ad) {
		tr[ls].ad+=tr[k].ad;
		tr[ls].mx+=tr[k].ad;
		tr[rs].ad+=tr[k].ad;
		tr[rs].mx+=tr[k].ad;
		tr[k].ad=0;
	}
}

inline void add(int k,int x,int y,int l,int r,int va) {
//	printf(&quot;%d %d %d %d %d\n&quot;,k,x,y,l,r);
	if(x&gt;=l&amp;&amp;y&lt;=r) {
		tr[k].ad+=va;
		tr[k].mx+=va;
		return ;
	}

	pushdown(k);
	if(l&lt;=mid)add(ls,x,mid,l,r,va);
	if(r&gt;mid)add(rs,mid+1,y,l,r,va);
	pushup(k);
}

int main() {
	//freopen(&quot;test.in&quot;,&quot;r&quot;,stdin);
	scanf(&quot;%d%d&quot;,&amp;n,&amp;m);
	for(int i=1; i&lt;=n; ++i) {
		scanf(&quot;%d%d&quot;,&amp;a[i].l,&amp;a[i].r);
		v.push_back(a[i].l);
		v.push_back(a[i].r);
	}
	sort(v.begin(),v.end());
	v.erase(unique(v.begin(),v.end()),v.end());
	for(int i=1; i&lt;=n; ++i) {
		a[i].len=a[i].r-a[i].l;
		a[i].l=lower_bound(v.begin(),v.end(),a[i].l)-v.begin();
		a[i].r=lower_bound(v.begin(),v.end(),a[i].r)-v.begin();
		//	printf(&quot;%d %d\n&quot;,a[i].l,v[a[i].l]);
	}
	sort(a+1,a+n+1);
//	for(int i=1; i&lt;=n; ++i) {
//		printf(&quot;%d %d\n&quot;,v[a[i].l],v[a[i].r]);
//	}
	int L=1,R=0;
	ll ans=1e18;
	for(R=1; R&lt;=n; ++R) {

		add(1,1,2*n+2,a[R].l+1,a[R].r+1,1);
		//	if(tr[1].mx&gt;=m)ans=min(ans,1ll*v[a[R].r]-v[a[R].l]-v[a[L].r]+v[a[L].l]);

		while(tr[1].mx==m) {
			ans=min(ans,1ll*a[R].len-a[L].len);
			//	puts(&quot;qwq&quot;);
			//	printf(&quot;%d %d %d\n&quot;,L,R,ans);
			add(1,1,2*n+2,a[L].l+1,a[L].r+1,-1);
			++L;
		}
	}
	if(ans&gt;1e17)return puts(&quot;-1&quot;),0;
	printf(&quot;%d\n&quot;,ans);
	return 0;

}

</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[P5319 [BJOI2019]å¥¥æœ¯ç¥æ–]]></title>
        <id>https://xiaxiaoguang.github.io/post/p5319-bjoi2019ao-zhu-shen-zhang/</id>
        <link href="https://xiaxiaoguang.github.io/post/p5319-bjoi2019ao-zhu-shen-zhang/">
        </link>
        <updated>2020-03-16T09:51:27.000Z</updated>
        <content type="html"><![CDATA[<p>BZOJæœ€åä¸€é¢˜</p>
<p>è¿™åšå®¢æ›´æ–°é€Ÿåº¦æœ‰ç‚¹æ…¢å•Š...æ±—TAT</p>
<p>æœ‰ä¸€ä¸ªé•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> çš„æ¯ä¸²ï¼Œå…¶ä¸­æŸäº›ä½ç½®å·²å›ºå®šï¼Œå¦ä¸€äº›ä½ç½®å¯ä»¥ä»»æ„å¡«ã€‚</p>
<p>åŒæ—¶ç»™å®š <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> ä¸ªå°ä¸²ï¼Œç¬¬ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> ä¸ªä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>â€‹ï¼Œæ‰€æœ‰ä½ç½®éƒ½å·²å›ºå®šï¼Œå®ƒçš„ä»·å€¼ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">V_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>â€‹ã€‚</p>
<p>æ¯æ¬¡æ¯ä¸ªå°ä¸²åœ¨æ¯ä¸²ä¸­å‡ºç°ä¸€æ¬¡ï¼Œä¾¿ä¼šç»™ç­”æ¡ˆçš„å¤šé‡é›†è´¡çŒ®ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">V_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚</p>
<p>æœ€ç»ˆçš„ç­”æ¡ˆä¸ºå¤šé‡é›†çš„å‡ ä½•å¹³å‡æ•°ï¼Œå®šä¹‰ç©ºé›†çš„å‡ ä½•å¹³å‡æ•°ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ã€‚</p>
<p>è¯·ä½ æ±‚å‡ºä¸€ä¸ªåˆæ³•æ¯ä¸²ï¼ˆå¾€å¯ä»¥å¡«çš„ä½ç½®å¡«åˆæ³•å­—ç¬¦ï¼‰ä½¿å¾—ç­”æ¡ˆæœ€å¤§ã€‚</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo separator="true">,</mo><mi>s</mi><mo>â‰¤</mo><mn>1501</mn></mrow><annotation encoding="application/x-tex">1\le n,s\le 1501</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8304100000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">5</span><span class="mord">0</span><span class="mord">1</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>â‰¤</mo><msub><mi>V</mi><mi>i</mi></msub><mo>â‰¤</mo><mi>max</mi><mo>â¡</mo><mi>V</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding="application/x-tex">1\le V_i\le \max V=10^9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mop">max</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span>ï¼Œå…¶ä¸­ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mi mathvariant="normal">âˆ£</mi><msub><mi>S</mi><mi>i</mi></msub><mi mathvariant="normal">âˆ£</mi></mrow><annotation encoding="application/x-tex">s=\sum_{i=1}^{m}|S_i|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span></span></span></span>ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬å¥½åƒæ˜¯è¦æ±‚ä¸ªæœ€å¤§çš„</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>n</mi><mi>s</mi><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mroot><mrow><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>c</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mrow><mi>c</mi></mroot><mo>)</mo></mrow><annotation encoding="application/x-tex">ans=max(\sqrt[c]{\prod_{i=1}^{c}{w_i}})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.1568160000000005em;vertical-align:-1.277669em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord sqrt"><span class="root"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5761668000000003em;"><span style="top:-2.8608868000000003em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size6 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span></span></span></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8791470000000006em;"><span class="svg-align" style="top:-5.116816em;"><span class="pstrut" style="height:5.116816em;"></span><span class="mord" style="padding-left:1.056em;"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.8391470000000005em;"><span class="pstrut" style="height:5.116816em;"></span><span class="hide-tail" style="min-width:0.742em;height:3.196816em;"><svg width='400em' height='3.196816em' viewBox='0 0 400000 3196' preserveAspectRatio='xMinYMin slice'><path d='M702 80H400000v40H742v3062l-4 4-4 4c-.667.7
-2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1h-12l-28-84c-16.667-52-96.667
-294.333-240-727l-212 -643 -85 170c-4-3.333-8.333-7.667-13 -13l-13-13l77-155
 77-156c66 199.333 139 419.667 219 661 l218 661zM702 80H400000v40H742z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>è¿™ä¸ªç©æ„æ€ä¹ˆå¤„ç†å‘¢?å¼€logå°±è¡Œäº†</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>n</mi><mtext>Â Â </mtext><mi>a</mi><mi>n</mi><mi>s</mi><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mfrac><mn>1</mn><mi>c</mi></mfrac><mo>âˆ—</mo><mrow><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>c</mi></munderover><mrow><mi>ln</mi><mo>â¡</mo><msub><mi>w</mi><mi>i</mi></msub></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">ln~~ans=max(\frac{1}{c}*{\sum_{i=1}^c{\ln w_i}})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">n</span><span class="mspace nobreak">Â </span><span class="mspace nobreak">Â </span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>æˆ‘ä»¬å‘ç°è¦æœ€å¤§åŒ–å‡å€¼....</p>
<p>å°±æ˜¯ä¸€ä¸ªç»å…¸çš„0/1åˆ†æ•°è§„åˆ’äº†,é‚£ä¹ˆ,æ³¨æ„<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>å·²ç»å»äº†å¯¹æ•°</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mn>1</mn><mi>c</mi></mfrac><mo>âˆ—</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>c</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><mo>&gt;</mo><mi>m</mi><mi>i</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">\frac{1}{c}*\sum_{i=1}^c{w_i}&gt;mid
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>c</mi></munderover><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>âˆ’</mo><mi>m</mi><mi>i</mi><mi>d</mi></mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum_{i=1}^c{w_i-mid}&gt;0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></span></p>
<p>è¿™æ ·å°±æ¯”è¾ƒç®€å•äº†,å¯ä»¥åœ¨å°ä¸²ä¸Šå»ºACè‡ªåŠ¨æœºä¸ŠDP</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>u</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">dp[i][u]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault">u</span><span class="mclose">]</span></span></span></span>è¡¨ç¤ºéå†å®Œæˆäº†å­—ç¬¦ä¸²å‰iä¸ªå­—ç¬¦,åŒ¹é…åœ¨ACè‡ªåŠ¨æœºuèŠ‚ç‚¹çš„æƒ…å†µæœ€å¤§å€¼</p>
<p>è½¬ç§»æ—¶è€ƒè™‘æ˜¯å¦iå­—ç¬¦ç¡®å®š,ä¸ç¡®å®šå°±éƒ½æ›´æ–°ä¸€ä¸‹</p>
<p>code:</p>
<pre><code class="language-cpp">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;queue&gt;
#include&lt;cmath&gt;
#define ll long long
using namespace std;

int n,m;
double w[1510];
char a[1510],s[1510][1510];
int ch[1510][10],ccnt=0,num[1510],fail[1510];
double sum[1510];

inline void ins(int x,int len) {
	int i,cur=0,tmp;
	for(i=1; i&lt;=len; ++i) {
		tmp=s[x][i]-'0';
		if(!ch[cur][tmp])ch[cur][tmp]=++ccnt;
		cur=ch[cur][tmp];
	}
	num[cur]++;//æ•°é‡å’Œs
	sum[cur]+=w[x];//sumæ˜¯æƒå€¼å’Œ
//	printf(&quot;%d - - %lf\n&quot;,num[cur],sum[cur]);
}
queue&lt;int&gt; q;
inline void build() {
	int i,u,v;
	for(i=0; i&lt;10; ++i) {
		if(!ch[0][i])continue;
		q.push(ch[0][i]);
		fail[ch[0][i]]=0;
	}
	while(!q.empty()) {
		u=q.front();
		q.pop();
		num[u]+=num[fail[u]];
		sum[u]+=sum[fail[u]];//ç»Ÿè®¡failæ ‘å’Œ
		for(i=0; i&lt;10; ++i) {
			v=ch[u][i];
			if(v) fail[v]=ch[fail[u]][i],q.push(v);
			else ch[u][i]=ch[fail[u]][i];//å»ºç«‹failè¾¹
		}
	}
	//for(int i=0; i&lt;=3; ++i)printf(&quot;%d-%lf\n&quot;,num[i],sum[i]);
}
double dp[1510][1510];
int from[1510][1510][2],endpos;

inline bool check(double mid) {
	register int i,j,k,son;
	for(i=0; i&lt;=n; ++i)
		for(j=0; j&lt;=ccnt; ++j)dp[i][j]=-2e20;
	//init
	for(i=0; i&lt;=ccnt; ++i) {
		sum[i]-=mid*(double)num[i];//æš´åŠ›å¤„ç†ä¸€ä¸‹
	}
	dp[0][0]=0;
	for(i=1; i&lt;=n; ++i) {
		for(j=0; j&lt;=ccnt; ++j) {
			if(dp[i-1][j]==-2e20)continue;
			if(a[i]!='.') {//ç›´æ¥è½¬ç§»
				son=ch[j][a[i]-'0'];
				if(dp[i][son]&lt;dp[i-1][j]+sum[son]) {
					dp[i][son]=dp[i-1][j]+sum[son];
					from[i][son][0]=j;
					from[i][son][1]=a[i]-'0';
				}
			} else {
				for(k=0; k&lt;10; ++k) {
					son=ch[j][k];
					if(dp[i][son]&lt;dp[i-1][j]+sum[son]) {
						dp[i][son]=dp[i-1][j]+sum[son];//å°±éƒ½æ›´æ–°ä¸€éå‘—
						from[i][son][0]=j;
						from[i][son][1]=k;//æš´åŠ›è®°ä½ä¸Šä¸ªèŠ‚ç‚¹å’Œè¿™ä¸ªå­—ç¬¦æ˜¯ä»€ä¹ˆ
					}
				}
			}
		}
	}
	int pos=0;
	for(i=1; i&lt;=ccnt; ++i)if(dp[n][i]&gt;dp[n][pos]) pos=i;//é€‰æ‹©ä¸ªæœ€ä¼˜çš„çŠ¶æ€
	for(i=0; i&lt;=ccnt; ++i)sum[i]+=mid*(double)num[i]; //è¿˜åŸå½±å“
	endpos=pos;
	//printf(&quot;%d?%lf\n&quot;,pos,dp[n][pos]);
	return dp[n][pos]&gt;0;//è¿”å›èƒ½å¦å¤§äº0
}
char re[1510];
int main() {
	scanf(&quot;%d%d&quot;,&amp;n,&amp;m);
	register int i;
	scanf(&quot;%s&quot;,a+1);
	for(i=1; i&lt;=m; ++i) {
		scanf(&quot;%s&quot;,s[i]+1);
		scanf(&quot;%lf&quot;,&amp;w[i]);
		w[i]=log((double)w[i]);//å¼ºè¡Œç²¾åº¦è¯¯å·®
//		printf(&quot;%lf?\n&quot;,w[i]);
		ins(i,strlen(s[i]+1));
	}
//	printf(&quot;%d?\n&quot;,ccnt);
	build();
	double l=0,r=log(1e9+7),mid,ans=0;
	while(r-l&gt;1e-6) {
		mid=(l+r)*0.5;
	//	printf(&quot;%lf %lf %lf\n&quot;,l,r,mid);
		if(check(mid))ans=mid,l=mid;//printf(&quot;%lfqwq\n&quot;,ans);
		else r=mid;
	}
	check(ans);
	for(i=n; i&gt;=1; --i) {
		re[i]=from[i][endpos][1]+'0';//è¾“å‡ºæ–¹æ¡ˆéƒ¨åˆ†
		endpos=from[i][endpos][0];//è·³fa
	}
	for(int i=1; i&lt;=n; ++i)putchar(re[i]);
	putchar('\n');
	return 0;
}


</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[P1224 [NOI2013]å‘é‡å†…ç§¯]]></title>
        <id>https://xiaxiaoguang.github.io/post/p1224-noi2013xiang-liang-nei-ji/</id>
        <link href="https://xiaxiaoguang.github.io/post/p1224-noi2013xiang-liang-nei-ji/">
        </link>
        <updated>2020-03-16T04:03:29.000Z</updated>
        <content type="html"><![CDATA[<p>NOI2013D1T1?</p>
<p>ä¸¤ä¸ª ddd ç»´å‘é‡ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>=</mo><mo>[</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>d</mi></msub><mo>]</mo></mrow><annotation encoding="application/x-tex">A=[a_1,a_2,\ldots,a_d]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> ä¸<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mo>=</mo><mo>[</mo><msub><mi>b</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>b</mi><mi>d</mi></msub><mo>]</mo></mrow><annotation encoding="application/x-tex">B=[b_1,b_2,\ldots,b_d]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>çš„å†…ç§¯ä¸ºå…¶ç›¸å¯¹åº”ç»´åº¦çš„æƒå€¼çš„ä¹˜ç§¯å’Œï¼Œå³ï¼š</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo>)</mo><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></msubsup><msub><mi>a</mi><mi>i</mi></msub><msub><mi>b</mi><mi>i</mi></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><msub><mi>b</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><msub><mi>b</mi><mn>2</mn></msub><mo>+</mo><mo>â€¦</mo><mo>+</mo><msub><mi>a</mi><mi>d</mi></msub><msub><mi>b</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">(A,B)=\sum_{i=1}^d a_ib_i=a_1b_1+a_2b_2+\ldots+a_db_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2887179999999998em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9890079999999999em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>ç°æœ‰ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> ä¸ª <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span>ç»´å‘é‡ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">x_1,\ldots,x_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>å°å–µå–µæƒ³çŸ¥é“æ˜¯å¦å­˜åœ¨ä¸¤ä¸ªå‘é‡çš„å†…ç§¯ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span>çš„å€æ•°ã€‚è¯·å¸®åŠ©å¥¹è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo>&lt;</mo><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">k&lt;=3
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span></span></p>
<p>è¿™ä¸ªk&lt;=3å°±å¾ˆæ£’,ç›´æ¥è’™åœˆçš„é‚£ç§</p>
<p>é¦–å…ˆä¸éš¾å‘ç°æˆ‘ä»¬æœ‰éšæœºåŒ–åšæ³•,å°±æ˜¯æ‰“ä¹±ç„¶å<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>N</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">N^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>çš„é‚£ç§,ä»–äººå®æµ‹åªæœ‰70...</p>
<p>100ptsåšæ³•,ä¸ä¸€å®šæ˜¯æ­£è§£å•Š</p>
<p>æˆ‘ä»¬è€ƒè™‘k=2çš„æ—¶å€™,å¯ä»¥æŠŠä»–ä»¬å‰i-1ä¸ªå‘é‡ç”¨å’Œå‹æˆä¸€ä¸ªå‘é‡</p>
<p>ç„¶åç”¨ç¬¬iä¸ªå‘é‡å»ä¹˜,å¦‚æœå’Œå‰é¢æ¯ä¸ªå‘é‡ä¹˜ç§¯éƒ½ä¸º1é‚£ä¹ˆå’Œå°±æ˜¯<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;&amp;&#039; at position 6: (i-1)&amp;Ì²1'>(i-1)&amp;1</span>,å¦åˆ™ä¸€å®šæœ‰ä¸€ä¸ªå‘é‡å’Œä»–çš„ä¹˜ç§¯ä¸æ˜¯1,å°±æ˜¯2çš„å€æ•°äº†,è¿™ä¸ªå¯ä»¥æš´åŠ›æ‰¾</p>
<p>å…·ä½“åªéœ€è¦ç»´æŠ¤dä¸ªä½ç½®å‰ç¼€å’Œå°±è¡Œäº†</p>
<p>å½“k=3æ—¶,è¿™ä¸ªä¹˜ç§¯ä¸ä¸º0å°±æ˜¯2æˆ–1,ä½†2æˆ–1éƒ½å¯ä»¥å¹³æ–¹ä¸€æ¬¡ä¹‹å%3=1</p>
<p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦ç»´æŠ¤dä¸ªä½ç½®å‰ç¼€å¹³æ–¹å’Œå°±è¡Œäº†,å¤æ‚åº¦æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi>n</mi><msup><mi>d</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(nd^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>è¿™æ ·ä»ç„¶å˜æˆäº†1å’Œä¹‹å‰ä¸€æ ·äº†</p>
<p>ç„¶è€Œå‚»å­ä¹Ÿèƒ½å‘ç°å¯èƒ½ä¼šå‡ºç°æ‰¾ä¸åˆ°è§£çš„æƒ…å†µ,ä¹Ÿå°±æ˜¯åŒæ—¶æœ‰ä¸¤ä¸ªéƒ½ä¹˜ç§¯ä¸ä¸º1</p>
<p>é‚£ä¹ˆè¿™æ ·æˆ‘ä»¬åªéœ€è¦random_shuffleä¸€ä¸‹é‡æ¥å°±è¡Œäº†</p>
<p>å…·ä½“å®ç°æ—¶å’ŒçŸ©é˜µä¹˜æ³•å·®ä¸å¤š</p>
<p>code:</p>
<pre><code class="language-cpp">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
using namespace std;
const int MAXN=1e5+7;
const int MAXM=107;
int n,m,mo,rand_now=MAXN*10,a[MAXN][MAXM],c[MAXN][MAXM],q[MAXN];
int id[MAXN],b[MAXM];

namespace fastIO {
#define BUF_SIZE (1&lt;&lt;19)
	static char buf[BUF_SIZE],*p1=buf+BUF_SIZE,*pend=buf+BUF_SIZE;
	inline char nc() {
		if(p1==pend) {
			p1=buf;
			pend=buf+fread(buf,1,BUF_SIZE,stdin);
		}
		return *p1++;
	}
	inline int read() {
		int x=0,f=1;
		char s=nc();
		for(; !isdigit(s); s=nc())if(s=='-')f=-1;
		for(; isdigit(s); s=nc())x=(x&lt;&lt;1)+(x&lt;&lt;3)+s-'0';
		return x*f;
	}
}
using namespace fastIO;

bool check(int x,int y) {
	int tmp=0;
	for(int i=1; i&lt;=m; ++i)tmp+=a[x][i]*a[y][i];
	//æ£€æŸ¥æ˜¯å¦ä¸º0
	return (tmp%mo==0);
}

inline int solve(int x) {
	int ans=0;
	if(mo==2)for(int i=1; i&lt;=m; b[i]^=a[x][i],++i)ans^=b[i]&amp;a[x][i];
	//å¼‚æˆ–ç›¸å½“äºåŠ äº†ä¹‹åå–æ¨¡
	//andä¸€ä¸‹,å°±ç›¸å½“äºä¹˜ç§¯ 
	else {
		for(int i=1; i&lt;=m; ++i) {
			for(int j=1; j&lt;=m; c[i][j]+=a[x][i]*a[x][j],++j)ans+=c[i][j]*a[x][i]*a[x][j];
            //è¿™ä¸ªå¹³æ–¹å’Œå…¶å®æ˜¯ä¸ªn^2çŸ©é˜µ?
		}
	}
	return ans%mo;
}

int main() {
//	freopen(&quot;test.in&quot;,&quot;r&quot;,stdin);
	n=read();
	m=read();
	mo=read();
	for(int i=1; i&lt;=n; ++i) {
		for(int j=1; j&lt;=m; ++j)a[i][j]=read()%mo;
	}
	for(int i=1; i&lt;=n; ++i)id[i]=i;
	for(int eps=1; eps&lt;=6; ++eps) {
		memset(b,0,sizeof(b));
		memset(c,0,sizeof(c));
		random_shuffle(id+1,id+n+1);
		for(int i=1; i&lt;=n; ++i) {
			if(solve(id[i])!=(i-1)%mo) {
				for(int j=1; j&lt;i; ++j) {
					if(check(id[i],id[j])) {
						if(id[i]&gt;id[j])swap(i,j);
						printf(&quot;%d %d\n&quot;,id[i],id[j]);
						return 0;
					}
				}
			}
		}
	}
	puts(&quot;-1 -1&quot;);
	return 0;
}

</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[P3830 [SHOI2012]éšæœºæ ‘]]></title>
        <id>https://xiaxiaoguang.github.io/post/p3830-shoi2012sui-ji-shu/</id>
        <link href="https://xiaxiaoguang.github.io/post/p3830-shoi2012sui-ji-shu/">
        </link>
        <updated>2020-03-16T03:06:52.000Z</updated>
        <content type="html"><![CDATA[<p>æ ¹æ®zhqwqçš„åˆ·é¢˜è®°å½•æ¥çš„</p>
<p>é¦–å…ˆè¿™æ˜¯ä¸€é“æœŸæœ›é¢˜,è€Œä¸”æ˜¯ç»å…¸æ ‘å½¢DPé¢˜</p>
<p>ç¬¬ä¸€é—®:</p>
<p>æˆ‘ä¸€å¼€å§‹sbäº†,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>[</mo><mi>i</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">f[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span>æ˜¾ç„¶è¡¨ç¤ºæœ‰iä¸ªå¶å­æ ‘çš„å¶å­æ·±åº¦æœŸæœ›å‡å€¼,ç„¶åæˆ‘æšä¸¾äº†å·¦å³å­æ ‘çš„å¶å­ä¸ªæ•°å¹¶ç®—å‡ºå¯¹åº”æ¦‚ç‡æ¥è½¬ç§»,è¿™æ˜¾ç„¶æ˜¯å¤æ‚çš„....</p>
<p>åªéœ€è¦è€ƒè™‘ä»i-1ä¸ªå¶å­åˆ°ç¬¬iä¸ªå¶å­,æ˜¾ç„¶æ·±åº¦ä¼šå¢åŠ 2,å¹³å‡åæ·±åº¦å¢åŠ 2/i,æ‰€ä»¥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>=</mo><mi>f</mi><mo>[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo>]</mo><mo>+</mo><mn>2</mn><mi mathvariant="normal">/</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">f[i]=f[i-1]+2/i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord">/</span><span class="mord mathdefault">i</span></span></span></span></p>
<p>ç¬¬äºŒé—®:</p>
<p>ä¸è¿‡æˆ‘ä¹‹å‰çš„æƒ³æ³•è¿˜æ˜¯æœ‰ç”¨å¤„çš„,ä¾‹å¦‚ç¬¬äºŒé—®?</p>
<p>æ ¹æ®ç¬¬ä¸€é—®çŠ¶æ€ä¸éš¾å¾—åˆ°ç¬¬äºŒé—®çŠ¶æ€æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>è¡¨ç¤ºæœ‰iä¸ªå¶å­ä¸”æ ‘æ·±åº¦æ°å¥½ä¸ºjçš„æœŸæœ›</p>
<p>è½¬ç§»æ—¶æˆ‘ä»¬è¦æšä¸¾å·¦å³å„¿å­çš„å¶å­æ•°å’Œæ·±åº¦,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>n</mi><mn>4</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(n^4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>,çœŸè‡ªé—­</p>
<p>æ‰€ä»¥æˆ‘ä»¬æœ‰ä¸ªç»å…¸trick----æ”¾æ¾çŠ¶æ€çš„é™åˆ¶!</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>è¡¨ç¤ºæœ‰iä¸ªå¶å­ä¸”æ ‘æ·±åº¦å¤§äºç­‰äºjçš„æœŸæœ›</p>
<p>è¿™æ ·è½¬ç§»çš„æ—¶å€™æœ‰ä¸€éƒ¨åˆ†å¾ˆå¥½æƒ³å‡ºæ¥</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></munderover><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>k</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo>]</mo><mo>+</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>âˆ’</mo><mi>k</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo>]</mo><mo>âˆ’</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>âˆ’</mo><mi>k</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo>]</mo><mo>âˆ—</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>k</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo>]</mo></mrow></mrow><annotation encoding="application/x-tex">dp[i][j]=\sum_{k=1}^{i-1}{dp[k][j-1]+dp[i-k][j-1]-dp[i-k][j-1]*dp[k][j-1]}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.1137820000000005em;vertical-align:-1.302113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8116690000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></span></p>
<p>çœ‹ä¸Šå»å¾ˆä¸é”™,ç„¶è€Œæ˜¯é”™çš„ ,å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰ä¹˜ä¸Šæ¯ç§æƒ…å†µçš„æ¦‚ç‡å‘¢</p>
<p><s>å…¶å®åœ¨ç¬¬äºŒé—®æ€è€ƒO(n^4)çš„æ—¶å€™å°±å·²ç»è§£å†³è¿™ä¸ªé—®é¢˜äº†,ä¸è¿‡å½“æ—¶æƒ³çš„æ˜¯å³è¾¹åªæœ‰1ä¸ªå¶å­çš„æƒ…å†µ</s></p>
<p>è€ƒè™‘ç»„åˆè®¡æ•°</p>
<p>é¦–å…ˆç”Ÿæˆä¸€ä¸ªå…¸å¼€çš„åºåˆ—æ–¹æ¡ˆæ•°æ˜¯ç¬¬ä¸€æ¬¡1ä¸ªé€‰æ‹©,ç¬¬äºŒæ¬¡2ä¸ªé€‰æ‹©....<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo>)</mo><mo>!</mo></mrow><annotation encoding="application/x-tex">(k-1)!</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">!</span></span></span></span>ç§ä¸åŒçš„æ–¹æ¡ˆ</p>
<p>è€Œç”Ÿæˆå·¦å­æ ‘æ˜¯(k-1)!,å³å­æ ‘å°±æ˜¯(i-k-1)!</p>
<p>è€Œæˆ‘ä»¬åˆå‘ç°å·¦å­æ ‘å³å­æ ‘ç»„åˆåœ¨ä¸€èµ·å½¢æˆä¸€ä¸ª01åºåˆ—,0è¡¨ç¤ºå…¸å¼€åœ¨å·¦å­æ ‘,1è¡¨ç¤ºå…¸å¼€åœ¨å³å­æ ‘,è¿™æ ·çš„åºåˆ—ä¸€å…±æœ‰<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mrow><mi>i</mi><mo>âˆ’</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo>+</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></mfrac><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mrow><mo>(</mo><mi>i</mi><mo>âˆ’</mo><mn>2</mn><mo>)</mo><mo>!</mo></mrow><mrow><mo>(</mo><mi>i</mi><mo>âˆ’</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo>)</mo><mo>!</mo><mo>(</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo>)</mo><mo>!</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\binom{i-k-1+k-1}{k-1}=\frac{(i-2)!}{(i-k-1)!(k-1)!}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3334389999999998em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9301079999999999em;"><span style="top:-2.355em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.144em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mclose mtight">!</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mclose mtight">!</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">2</span><span class="mclose mtight">)</span><span class="mclose mtight">!</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<p>å‘ç°äº†ä»€ä¹ˆ?æˆ‘ä»¬è¿™ä¸‰ä¸ªä¹˜ç§¯æ˜¯å·¦å­æ ‘kä¸ªå³å­æ ‘i-kä¸ªçš„æ€»æ–¹æ¡ˆæ•°,è€Œè¿™ä¸ªä¸œè¥¿æ˜¯ä¸€å®šå€¼</p>
<p>æ„å‘³ç€æ¯ç§æƒ…å†µçš„æ–¹æ¡ˆæ•°ç›¸åŒ</p>
<p>æ‰€ä»¥æ¯ç§æƒ…å†µå æ¯”ç›¸åŒ,éƒ½æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mo>(</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">1/(i-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p>
<p>code:</p>
<pre><code class="language-cpp">#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;cstdio&gt;
using namespace std;
int p,n;
double f[110],dp[110][110],ans;

int main() {
	scanf(&quot;%d%d&quot;,&amp;p,&amp;n);
	if(p==1) {
		f[1]=0;
		for(int i=2; i&lt;=n; ++i)f[i]=f[i-1]+2.0/i;
		printf(&quot;%.6f&quot;,f[n]);
	} else {
		for(int i=1; i&lt;=n; ++i)dp[i][0]=1;
		for(int i=2; i&lt;=n; ++i) {
			for(int j=1; j&lt;i; ++j) {
				for(int k=1; k&lt;i; ++k) {
					dp[i][j]+=dp[k][j-1]+dp[i-k][j-1]-dp[k][j-1]*dp[i-k][j-1];
				}
				dp[i][j]/=(i-1);
			}
		}
		for(int i=1; i&lt;n; ++i)ans+=dp[n][i];
		printf(&quot;%.6f&quot;,ans);
	}
	return 0;
}

</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[CF506E Mr. Kitayuta's Gift]]></title>
        <id>https://xiaxiaoguang.github.io/post/cf506e-mr-kitayutas-gift/</id>
        <link href="https://xiaxiaoguang.github.io/post/cf506e-mr-kitayutas-gift/">
        </link>
        <updated>2020-03-15T23:10:52.000Z</updated>
        <content type="html"><![CDATA[<p>IOI2020é›†è®­é˜Ÿä½œä¸š</p>
<p>é›†è®­é˜Ÿä½œä¸š(æˆ–è€…è¯´CF)ç»ˆäºå±•ç°å‡ºä»–å¯æ€•çš„ä¸€é¢</p>
<ul>
<li>ç»™å®šä¸€ä¸ªå°å†™å­—ç¬¦ä¸² <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span></span></span></span> å’Œä¸€ä¸ªæ­£æ•´æ•° <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>ã€‚</li>
<li>è¦æ±‚åœ¨ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span></span></span></span> ä¸­æ’å…¥æ°å¥½ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> ä¸ªå°å†™å­—ç¬¦ä½¿å…¶å›æ–‡çš„æ–¹æ¡ˆæ•°ã€‚</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mi mathvariant="normal">âˆ£</mi><mo>â‰¤</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">|s| \le 200</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ£</span><span class="mord mathdefault">s</span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">0</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding="application/x-tex">n \le 10^9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span>ï¼Œç­”æ¡ˆå¯¹ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup><mo>+</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">10^4 + 7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span></span></span></span> å–æ¨¡ã€‚</li>
</ul>
<p>é¦–å…ˆè¿™é“é¢˜è‚¯å®šæ˜¯è¦DPçš„,ç„¶è€Œè¿™ä¸ªnå®åœ¨ä¸æ•¢æ­ç»´,æ¨¡æ•°å¤§å°ä¹Ÿä¸€èˆ¬æ²¡ç”¨</p>
<p>é¢˜ç›®å˜æˆé•¿åº¦ä¸º|S|+nçš„æ‰€æœ‰å­—ç¬¦ä¸²åŒ…å«|S|ä¸ºå­åºåˆ—çš„æœ‰å¤šå°‘ä¸ª</p>
<p><code>æˆ‘ä»¬ä»¿ç…§ä¸€èˆ¬çš„å¯¹å­—ç¬¦ä¸²è¿›è¡Œdpçš„å¥—è·¯,æˆ‘ä»¬ä¸åœçš„ä¸€ä½ä¸€ä½çš„æ”¾å­—ç¬¦æ¥è¿›è¡Œå†³ç­–,æ¢å¥è¯è®²æˆ‘ä»¬çš„è½¬ç§»å°±æ˜¯æšä¸¾ä¸‹ä¸€ä½æ”¾ä»€ä¹ˆ,è¿™æ ·dpæœ‰ä¸€ä¸ªç›¸å½“æ£’çš„å¥½å¤„å°±æ˜¯æˆ‘ä»¬æ°¸è¿œä¸ä¼šé‡å¤æ•°åŒä¸€ä¸ªä¸²</code></p>
<p>å…ˆä»DPå…¥æ‰‹å§,ç»å…¸å­—ç¬¦ä¸²DPå¥—è·¯,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mi>k</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">dp[i][j][k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span>è¡¨ç¤ºSå­—ç¬¦ä¸²ä»i-&gt;jæ²¡æœ‰åŒ¹é…,å½“å‰å­—ç¬¦ä¸²ä»å‰æ•°kä¸ªä½ç½®åˆ°ä»åæ•°kä¸ªä½ç½®å·²ç»åŒ¹é…,æ³¨æ„,Sæ˜¯å½“å‰å­—ç¬¦ä¸²çš„ä¸€ä¸ªå­åºåˆ—,çš„æ–¹æ¡ˆæ•°</p>
<p>å¦è®¾target(k)è¡¨ç¤ºå‰kä½å’Œåkä¸ºå·²ç»ç¡®å®šæ—¶åŒ…å«åŒ…å«Sè¿™ä¸ªå­åºåˆ—çš„å­—ç¬¦ä¸²æ•°</p>
<p>è½¬ç§»å°±æ˜¯å¤´å°¾åŒæ—¶æ·»åŠ ä¸€ä¸ªå­—ç¬¦,å› ä¸ºå¦‚æœçŠ¶æ€è®¾è®¡æˆ–è½¬ç§»çš„ä¸å¥½å°±å¯èƒ½å°†ä¸€ä¸ªä¸²å¤šæ¬¡è®¡æ•°äº†</p>
<p><code>æ‰€ä»¥æˆ‘ä»¬é‡‡å–è¿™æ ·ä¸€ç§ç­–ç•¥åŒ¹é…å­åºåˆ—ä»å¤´å°¾ä¸¤ç«¯åŒæ—¶æ·»åŠ å­—ç¬¦,ä¸€æ—¦å¯ä»¥å’Œ$S$åŒ¹é…å­åºåˆ—å°±è¿›è¡ŒåŒ¹é…,å¯ä»¥è¯æ˜çš„æ˜¯å¦‚æœè¿™ä¸ªå­—ç¬¦ä¸²å«æœ‰å­åºåˆ—$S$å°±è‚¯å®šèƒ½è¢«è¿™ä¸ªç®—æ³•è¯†åˆ«å‡ºä¸€ä¸ªå­åºåˆ—æ¥ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜å¯ä»¥è¯æ˜çš„æ˜¯å¯¹äºåŒä¸€ä¸ªå­—ç¬¦ä¸²è¢«è¯†åˆ«å‡ºçš„å­åºåˆ—æœ‰ä¸”ä»…æœ‰ä¸€ç§,å› æ­¤æˆ‘ä»¬ä¼šå‘ç°è¿™æ ·è®¾è®¡çŠ¶æ€çš„è¯æ¯ä¸ªå­—ç¬¦ä¸²å°±åªä¼šè¢«ç»Ÿè®¡ä¸€æ¬¡äº†,æ‰€ä»¥æˆ‘ä»¬çš„&quot;è¿˜æ²¡æœ‰åŒ¹é…çš„åŒºé—´&quot;æŒ‡çš„å°±æ˜¯è¿™æ ·è´ªå¿ƒçš„åŒ¹é…å®Œå‰å$k$ä½ä¹‹å</code></p>
<p>ç„¶åå…·ä½“çš„....å…ˆè€ƒè™‘å¶é•¿åº¦å­—ç¬¦ä¸²å§,æ˜¾ç„¶<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi><mo>&gt;</mo><mo>=</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">j&gt;=i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span></p>
<h2 id="case-1sisjj-i1">case 1:<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;&amp;&#039; at position 11: S[i]==S[j]&amp;Ì²&amp;j-i&lt;=1'>S[i]==S[j]&amp;&amp;j-i&lt;=1</span></h2>
<p>æˆ‘ä»¬å†æ”¾ä¸€ä¸ªS(i)å°±æ‹¼å®Œäº†,å¦å¤–æˆ‘ä»¬è¿˜å¯ä»¥çæ”¾,ä½†åªèƒ½ä½¿åŒ¹é…k+1</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo>(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>)</mo><mo>+</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mi>k</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">target(k+1)+=dp[i][j][k]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">+</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>]</mo><mo>+</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mi>k</mi><mo>]</mo><mo>âˆ—</mo><mn>25</mn></mrow><annotation encoding="application/x-tex">dp[i][j][k+1]+=dp[i][j][k]*25
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mord">+</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">5</span></span></span></span></span></p>
<h2 id="case2sisjj-i1">case2:<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;&amp;&#039; at position 11: S[i]==S[j]&amp;Ì²&amp;j-i&gt;1'>S[i]==S[j]&amp;&amp;j-i&gt;1</span></h2>
<p>ä»¿ç…§ä¸Šé¢çš„å§,targetæ— æ³•æ›´æ–°,æˆ‘ä»¬å¯ä»¥ä¸€ä¸‹åŒ¹é…Sä¸¤ä¸ªä½ç½®,ä¹Ÿå¯ä»¥k+1</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>]</mo><mo>+</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mi>k</mi><mo>]</mo><mo>âˆ—</mo><mn>25</mn></mrow><annotation encoding="application/x-tex">dp[i][j][k+1]+=dp[i][j][k]*25
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mord">+</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">5</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>]</mo><mo>[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo>]</mo><mo>[</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>]</mo><mo>+</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mi>k</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">dp[i+1][j-1][k+1]+=dp[i][j][k]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mord">+</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span></span></p>
<h2 id="case3sisj">case3:<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>!</mo><mo>=</mo><mi>S</mi><mo>[</mo><mi>j</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">S[i]!=S[j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span></h2>
<p>æˆ‘ä»¬åªèƒ½é€‰æ‹©å…¶ä¸­ä¸€æ–¹åŒ¹é…,æˆ–è€…k+1</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>]</mo><mo>+</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mi>k</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">dp[i+1][j][k+1]+=dp[i][j][k]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mord">+</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo>]</mo><mo>[</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>]</mo><mo>+</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mi>k</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">dp[i][j-1][k+1]+=dp[i][j][k]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mord">+</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>]</mo><mo>+</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo><mo>[</mo><mi>k</mi><mo>]</mo><mo>âˆ—</mo><mn>24</mn></mrow><annotation encoding="application/x-tex">dp[i][j][k+1]+=dp[i][j][k]*24
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mord">+</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">4</span></span></span></span></span></p>
<h2 id="case4target">case4:target</h2>
<p>æ˜¾ç„¶targetå¯ä»¥éšä¾¿å¡«</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo>(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>)</mo><mo>+</mo><mo>=</mo><mn>26</mn><mo>âˆ—</mo><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo>(</mo><mi>k</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">target(k+1)+=26*target(k)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">+</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></span></p>
<p>é‚£ä¹ˆæ˜¾ç„¶æˆ‘ä»¬åªéœ€è¦<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo>(</mo><mo>(</mo><mi mathvariant="normal">âˆ£</mi><mi>S</mi><mi mathvariant="normal">âˆ£</mi><mo>+</mo><mi>n</mi><mo>)</mo><mi mathvariant="normal">/</mi><mn>2</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">target((|S|+n)/2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mopen">(</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span></span></span></span>çš„å€¼å°±æ˜¯ç­”æ¡ˆäº†,å‘ç°æ¯æ¬¡éƒ½ä»k-&gt;k+1,é‚£ä¹ˆkä¸ç”¨è®¡å…¥çŠ¶æ€ä¸­å¯ä»¥ç›´æ¥çŸ©é˜µä¹˜æ³•,è¿™æ ·æˆ‘ä»¬çŸ©é˜µè‡³å°‘è¦è®°å½•<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">âˆ£</mi><mi>S</mi><msup><mi mathvariant="normal">âˆ£</mi><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">|S|^4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span>å¤§å°çš„ä¿¡æ¯,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi mathvariant="normal">âˆ£</mi><mi>S</mi><msup><mi mathvariant="normal">âˆ£</mi><mn>6</mn></msup><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><mi mathvariant="normal">âˆ£</mi><mi>S</mi><mi mathvariant="normal">âˆ£</mi><mo>+</mo><mi>n</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">O(|S|^6log(|S|+n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></p>
<p>ä¸è¡Œ,æˆ‘ä»¬æ¥ä¼˜åŒ–ä¸€ä¸‹,æ˜æ˜¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæµªè´¹,å°±æ˜¯åªéœ€è¦targetä¸€é¡¹çš„å€¼,æ‰€ä»¥æˆ‘ä»¬è¦åƒä¸ªåŠæ³•åˆ©ç”¨èµ·æ¥</p>
<p>è€ƒè™‘DPçš„æœ¬è´¨å…¶å®æ˜¯ä¸€ä¸ªDAGä¸Šå›¾è®º?æ‰€ä»¥å¦‚æœçŠ¶æ€Aåˆ°çŠ¶æ€Bæœ‰</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>p</mi><mo>(</mo><mi>A</mi><mo>)</mo><mo>+</mo><mo>=</mo><mi>C</mi><mo>âˆ—</mo><mi>d</mi><mi>p</mi><mo>(</mo><mi>B</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">dp(A)+=C*dp(B)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mord">+</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span></span></p>
<p>å°±åœ¨ç‚¹Bå‘ç‚¹Aè¿Cæ¡æœ‰å‘è¾¹,(å¦‚æœåªæœ‰kå€¼ä¸åŒæˆ‘ä»¬çœ‹åšç›¸åŒçš„çŠ¶æ€å“¦)</p>
<p>é‚£ä¹ˆæ˜¾ç„¶å»æ‰ä¸€äº›è‡ªç¯å°±æ˜¯DAGäº†!é‚£ä¹ˆé—®é¢˜ä¹Ÿç›¸å¯¹çš„è½¬åŒ–ä¸€ä¸‹,å˜ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(1,n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>è¿™ä¸ªç‚¹åˆ°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo>(</mo><mo>(</mo><mi mathvariant="normal">âˆ£</mi><mi>S</mi><mi mathvariant="normal">âˆ£</mi><mo>+</mo><mi>n</mi><mo>)</mo><mi mathvariant="normal">/</mi><mn>2</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">target((|S|+n)/2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mopen">(</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span></span></span></span>èµ°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi mathvariant="normal">âˆ£</mi><mi>S</mi><mi mathvariant="normal">âˆ£</mi><mo>+</mo><mi>n</mi><mo>)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">(|S|+n)/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mord">/</span><span class="mord">2</span></span></span></span>æ¡è¾¹è·¯å¾„æ–¹æ¡ˆæ€»æ•°</p>
<p>å¾ˆå¥½,é—®é¢˜å˜æˆå›¾çš„è·¯å¾„è®¡æ•°äº†!</p>
<p>ä½†é¦–å…ˆè¦è§£å†³è‡ªç¯,è‡ªç¯åªæœ‰24,25,26ä¸‰ç§å‘¢</p>
<p>è¿™åˆæœ‰ä»€ä¹ˆç”¨å¤„å‘¢?æˆ‘ä»¬ä»”ç»†è§‚å¯Ÿå›¾ä¸Šæ¯ä¸€æ¡è·¯å¾„,å¤§éƒ¨åˆ†çš„æ—¶é—´æˆ‘ä»¬éƒ½åœ¨èµ°è‡ªç¯äº†!ç»è¿‡çš„ç‚¹çš„ç§ç±»å´å¾ˆå°‘,æœ€å¤šç»è¿‡<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">âˆ£</mi><mi>S</mi><mi mathvariant="normal">âˆ£</mi></mrow><annotation encoding="application/x-tex">|S|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord">âˆ£</span></span></span></span>ä¸ªç‚¹,è¿™ä¸ªè§‚å¯ŸçŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸éš¾å¾—å‡º</p>
<p>é‚£æˆ‘ä»¬æŠŠè·¯å¾„æŒ‰ç…§ç»è¿‡ç‚¹çš„ç‚¹é›†åˆ†ç±»,ä¸€ç±»è·¯å¾„å°±æ˜¯èµ°ç›¸åŒçš„ç‚¹é›†åˆ°ç»ˆç‚¹çš„è·¯å¾„,é‚£ä¹ˆä¸€ç±»è·¯å¾„ä¸­ä¸åŒçš„è·¯å¾„å°±ä¸€å®šæ˜¯èµ°è‡ªç¯çš„æ–¹å¼ä¸åŒäº†</p>
<p>å…¶ä¸­26çš„é™åˆ¶åªæœ‰åœ¨ç»ˆç‚¹ä¸Šæœ‰,æˆ‘ä»¬åªéœ€è¦æš´åŠ›ä¹˜è¿›å»å°±è¡Œäº†</p>
<p>è€Œ24å’Œ25çš„ç‚¹å‘¢?æˆ‘ä»¬å‘ç°ä¸€ä¸ªæ€§è´¨,å¦‚æœå·²çŸ¥ä¸€æ¡è·¯å¾„(ç»è¿‡çš„ç‚¹å†™æˆåºåˆ—)æœ‰aä¸ªè‡ªç¯æ•°ä¸º24çš„ç‚¹,é‚£ä¹ˆä¸€å®šæœ‰ç»è¿‡è‡ªç¯æ•°ä¸º25çš„ç‚¹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>âŒˆ</mo><mfrac><mrow><mi>n</mi><mo>âˆ’</mo><mi>a</mi></mrow><mn>2</mn></mfrac><mo>âŒ‰</mo></mrow><annotation encoding="application/x-tex">\lceil{\frac{n-a}{2}}\rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1473309999999999em;vertical-align:-0.345em;"></span><span class="mopen">âŒˆ</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.802331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">âˆ’</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mclose">âŒ‰</span></span></span></span>,è¿™ä¸ªå¯ä»¥ç”±DPè½¬ç§»ç‰¹æ€§å¾—å‡º,å› ä¸ºæˆ‘ä»¬èµ°ç¯ä¸º24çš„ç‚¹æ—¶å°±æ¶ˆè€—ä¸€ä¸ªå­—ç¬¦,è€Œèµ°è‡ªç¯ä¸º25çš„ç‚¹æ¶ˆè€—ä¸¤ä¸ªå­—ç¬¦,åˆå› ä¸ºæˆ‘ä»¬åªèµ°è¿™ä¸¤ç§ç‚¹,æ‰€ä»¥å¯ä»¥,ä¸ºä»€ä¹ˆä¸Šå–æ•´å‘¢?å› ä¸ºç»è¿‡<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>i</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(i,i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span>æ—¶ç¯é•¿25ä½†æ˜¯åªèŠ±äº†1ä¸ªå­—ç¬¦å‘¢</p>
<p>è¿™ä¸ªæ€§è´¨å‘Šè¯‰æˆ‘ä»¬ä»€ä¹ˆ?æœ¬è´¨ä¸åŒçš„è·¯å¾„æ¡æ•°åªæœ‰O(|S|)ç§!!!å› ä¸ºåªæœ‰åŒ…å«è‡ªç¯24çš„ç‚¹æ•°é‡ä¸åŒçš„è·¯å¾„æ‰æœ¬è´¨ä¸åŒ,å¦åˆ™ä¸€å®šç›¸åŒ,å› ä¸ºè‡ªç¯25çš„ç‚¹æ•°å¯ä»¥æ¨å‡ºæ¥</p>
<p>è€ƒè™‘åŸå›¾çš„è‡ªåŠ¨æœºæ˜¯ä¸æ˜¯å°±å¯ä»¥å‹ç¼©äº†?</p>
<p>åŸæ¥æ˜¯ä¸€ä¸ªå¤æ‚çš„å›¾,å¯èƒ½é•¿è¿™æ ·<img src="https://www.xht37.com/wp-content/uploads/2020/02/61e9c25b977bad7af00165b92070a9acabf16704.png" alt="qwq" loading="lazy"></p>
<p>ç„¶è€Œæˆ‘ä»¬åªéœ€è¦è‡ªç¯24çš„ç‚¹ä¸åŒ,æ±‚è¿™äº›è·¯å¾„æœ¬è´¨ä¸åŒæ–¹æ¡ˆæ•°,æ‰€ä»¥å¯ä»¥å‹ç¼©ä¸º<br>
<img src="https://www.xht37.com/wp-content/uploads/2020/02/1077980-20180401083928510-472522990.png" alt="qwq" loading="lazy"></p>
<p>åœ¨è¿™ä¸Šé¢çŸ©é˜µä¹˜æ³•</p>
<p>å½“ç„¶,æˆ‘ä»¬è¿˜éœ€è¦æ±‚å‡ºæœ‰kä¸ªçº¢ç‚¹é“¾çš„æ€»æ•°é‡,è¿™ä¸ªåªè¦åœ¨åŸå›¾ä¸­ç”¨è®°å¿†åŒ–æœç´¢å¤„ç†ä¸€ä¸‹å³å¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi mathvariant="normal">âˆ£</mi><mi>S</mi><msup><mi mathvariant="normal">âˆ£</mi><mn>3</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(|S|^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>|S|æ¡é“¾,æ¯ä¸ªé“¾|S|ä¸ªç‚¹,è¿™ä¸ªè¿‡ç¨‹ä¸éš¾å‘ç°æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi mathvariant="normal">âˆ£</mi><mi>S</mi><msup><mi mathvariant="normal">âˆ£</mi><mn>4</mn></msup><mi>l</mi><mi>o</mi><mi>g</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">O(|S|^4log...)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mclose">)</span></span></span></span></p>
<p>æ˜¾ç„¶ç…§Tä¸è¯¯,æˆ‘ä»¬å†è€ƒè™‘ä¼˜åŒ–ä¸€ä¸‹,å› ä¸ºæˆ‘ä»¬æœ‰ä¸€ä¸ªO(|S|^2)å¤§å°çŸ©é˜µä½†æ˜¯åªç”¨å…¶ä¸­çš„ä¸€ä¸ªæ•°...</p>
<p>çŸ©é˜µä¹˜æ³•å…¶å®æ”¯æŒå¤šä¸ªæºç‚¹å’Œæ±‡ç‚¹çš„,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">C(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>å°±è¡¨ç¤ºä»ièµ°åˆ°jçš„æ–¹æ¡ˆæ•°å‘¢,æ‰€ä»¥æˆ‘ä»¬è¦å°½å¯èƒ½çš„åˆ©ç”¨ä¸€ä¸ªçŸ©é˜µå†…çš„ä¿¡æ¯,æ€ä¹ˆåŠ?é‡æ„å›¾è®©ä»–æ»¡è¶³</p>
<p>æ‰€ä»¥æˆ‘ä»¬å†æŠŠè‡ªåŠ¨æœºå‹ç¼©ä¸€ä¸‹!!!<img src="https://www.xht37.com/wp-content/uploads/2020/02/1077980-20180401083928510-472522990.png" alt="qaq" loading="lazy"></p>
<p>è¿™ä¸€æ­¥æˆ‘ä»¬ä¼šå‘ç°åŸæ¥æ¯ç±»é“¾éƒ½èƒ½åœ¨è¿™ä¸ªå›¾ä¸­è¡¨ç¤ºå‡ºæ¥!å‹ç¼©åçš„è‡ªåŠ¨æœºç‚¹æ•°å°±åªæœ‰<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi mathvariant="normal">âˆ£</mi><mi>S</mi><mi mathvariant="normal">âˆ£</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">O(|S|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord">âˆ£</span><span class="mclose">)</span></span></span></span>ä¸ªäº†.......è¿™æ—¶å€™å†æ¬¡çŸ©é˜µå¿«é€Ÿå¹‚,å°±æœ‰<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi mathvariant="normal">âˆ£</mi><mi>S</mi><msup><mi mathvariant="normal">âˆ£</mi><mn>3</mn></msup><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><mi>n</mi><mo>+</mo><mi>S</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">O(|S|^3log(n+S))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></p>
<p>è‡ªå·±æ ¸ç®—ä¸€ä¸‹,è¿˜æ˜¯è¿‡ä¸äº†çš„,æ¯•ç«Ÿ100w*30....</p>
<p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦å¡å¸¸å°±è¡Œäº†!è®©ä»–è·‘ä¸æ»¡!!</p>
<p>æˆ‘ä»¬è®¾è®¡å›¾çš„æ—¶å€™åªè®©ç¼–å·å°çš„å‘ç¼–å·å¤§çš„ç‚¹è½¬ç§»,è¿™æ ·çŸ©é˜µä¹˜æ³•åªéœ€è¦ä¸€ä¸ªä¸Šä¸‰è§’çŸ©é˜µ,è¿™æ ·çŸ©é˜µä¹˜æ³•çš„å¤æ‚åº¦å°±é™¤äº†6,çœ‹ä¸Šå»å¯è¿‡</p>
<blockquote>
<p>å¥‡æ•°é•¿åº¦ä¸²å¤„ç†æ–¹å¼</p>
</blockquote>
<p>å”¯ä¸€çš„åŒºåˆ«å¥½åƒæ˜¯case1,j-i=1çš„æ—¶å€™ä¸èƒ½ä¸€ä¸‹è½¬ç§»å®Œäº†,æ‰€ä»¥è¦å‰ªæ‰è¿™äº›éƒ¨åˆ†,å°±åªä¿ç•™è¿™æ ·çš„é“¾,åŒæ—¶å»æ‰ç»ˆç‚¹è‡ªç¯(å› ä¸ºä»–åªèƒ½å¡«ä¸­é—´å›ºå®šçš„é‚£ä¸ªå­—ç¬¦äº†),å†ç®—ä¸€ä¸‹å°±æ˜¯æˆ‘ä»¬è¦å»æ‰çš„æ–¹æ¡ˆæ•°äº†</p>
<p>è€Œå…¶ä»–çŠ¶æ€éƒ½å¯ä»¥ä¸­å¿ƒå­—ç¬¦éšä¾¿æ</p>
<p>å°±è¿™æ ·,è¿™é“ç¥ä»™é¢˜å®Œäº†</p>
<p>code:</p>
<pre><code class="language-cpp">
#include&lt;iostream&gt;
#include&lt;algorithm&gt;
using namespace std;
const int MAXN=2*1e2+10;
const int P=10007;
int tr[MAXN][MAXN];
int tp[MAXN*MAXN];
int n;
char mde[MAXN];
int m,ctt,S,ans;
int trp[MAXN&lt;&lt;1][MAXN&lt;&lt;1];
struct Grph {
	int to[2*MAXN*MAXN];
	int nxt[2*MAXN*MAXN];
	int ccnt;
	int home[MAXN*MAXN],dp[MAXN][MAXN*MAXN];
	bool book[MAXN][MAXN*MAXN];
	inline void add(int u,int v) {
		to[++ccnt]=v;
		nxt[ccnt]=home[u];
		home[u]=ccnt;
	}
	inline int dfs(int cnt,int u) {
		if(cnt&lt;0)return 0;
		if(book[cnt][u])return dp[cnt][u];//è®°å¿†åŒ–æœç´¢
		book[cnt][u]=1;//è¿™ä¸ªçŠ¶æ€ç®—è¿‡äº†
		for(int i=home[u]; i; i=nxt[i])(dp[cnt][u]+=dfs(cnt-tp[u],to[i]))%=P;//åŠ ä¸Š
		return dp[cnt][u];
	}
} g2;

struct mar {
	int mp[MAXN&lt;&lt;1][MAXN&lt;&lt;1];
	inline int* operator[](const int x) {
		return mp[x];
	}
	void operator*=(const mar &amp;b) {
		for(int i=1; i&lt;=S; ++i)
			for(int j=1; j&lt;=S; ++j)trp[i][j]=0;
		for(int i=1; i&lt;=S; ++i)
			for(int k=i; k&lt;=S; ++k)
				for(int j=k; j&lt;=S; ++j)
					(trp[i][j]+=mp[i][k]*b.mp[k][j])%=P;
		for(int i=1; i&lt;=S; ++i)
			for(int j=1; j&lt;=S; ++j)mp[i][j]=trp[i][j];
	}
} trs,res;


int f[MAXN],g[MAXN];
int main() {
	scanf(&quot;%s&quot;,mde+1);
	scanf(&quot;%d&quot;,&amp;m);
	for(n=1; mde[n+1]!='\0'; ++n);
	for(int i=1; i&lt;=n; ++i)
		for(int j=i; j&lt;=n; ++j)
			tr[i][j]=++ctt;//è¿™é‡ŒåŸæ¥æ˜¯é‡ç¼–å·,ä¿è¯äº†ä»ç¼–å·å°çš„å‘ç¼–å·å¤§çš„è½¬ç§»
	++ctt;
	for(int i=1; i&lt;=n; ++i) {
		for(int j=i; j&lt;=n; ++j) {
			if(mde[i]==mde[j]) {
				if(j-i&lt;=1)g2.add(ctt,tr[i][j]);//åªè¿ä¸€æ¡è¾¹

				else g2.add(tr[i+1][j-1],tr[i][j]);//å¦åˆ™ä»i+1,j-1å¯ä»¥è½¬ç§»åˆ°i,j
			} else {
				tp[tr[i][j]]=1;//è¿™ä¸ªä¸œè¥¿

				g2.add(tr[i+1][j],tr[i][j]),g2.add(tr[i][j-1],tr[i][j]);
				//å…ˆæ„å»ºåŸå›¾æ¥è®°æœ
			}
		}
	}
	for(int i=0; i&lt;n; ++i)g2.book[i][tr[1][n]]=1;
	g2.dp[tp[tr[1][n]]][tr[1][n]]=1;
	//é ,è¿™æ˜¯è®¾è®¡åˆçŠ¶æ€.....
	for(int i=0; i&lt;n; ++i)g2.dfs(i,ctt);
	//è®°å¿†åŒ–æœç´¢æ¯ä¸ªå¡«çš„
	for(int i=1; i&lt;n; ++i)trs[i][i]=24;
	//è¿™äº›ç‚¹åªå¯24
	int t=(n+1)/2;
	for(int i=0; i&lt;t; ++i)trs[i+n][n+i]=25;
	//è¿™äº›ç‚¹æ˜¯25
	for(int i=0; i&lt;t; ++i)trs[n+t+i][n+t+i]=26;
	//ç»ˆç‚¹
	for(int i=1; i&lt;n+t-1; ++i)trs[i][i+1]++;
	//ä½ æƒ³åƒä¸€ä¸‹ä¹‹å‰çš„é‚£ä¸ªä¸¤æ¡é“¾çš„å›¾ç¬¬ä¸€æ¡é“¾ç›¸é‚»ç‚¹çš„è¾¹
	for(int i=0; i&lt;t; ++i)trs[n+i][n+t+i]++;
	//è¿™ä¸ªæ˜¯ç¬¬äºŒæ¡é“¾çš„å¯¹åº”è¾¹
//	for(int i=0; i&lt;n; ++i) {
//		for(int j=0; j&lt;n; ++j) {
//			printf(&quot;%d &quot;,trs[i][j]);
//		}
//		puts(&quot;&quot;);
//	}
	S=n+(t&lt;&lt;1)-1;
	for(int i=1; i&lt;=S; ++i)res[i][i]=1;
	//å•ä½çŸ©é˜µ
	for(int p=(n+m)&gt;&gt;1; p; p&gt;&gt;=1,trs*=trs)if(p&amp;1)res*=trs;//é ,å¿«é€Ÿå¹‚

	for(int i=0,v; i&lt;n; ++i)v=(n-i+1)/2,f[i]=res[n-i][n+t+v-1],g[i]=res[n-i][n+v-1];//è¿™ä¸ªgå…¶å®æ˜¯æœ€ååˆ°å•ä¸ªå­—ç¬¦çš„ 
	//è¿™æ˜¯åœ¨æšä¸¾æ‰€æœ‰è·¯å¾„ç±»,ç„¶åå¾—åˆ°å¯¹åº”
	if((n+m)&amp;1) {
		for(int i=0; i&lt;n; ++i)(ans+=f[i]*g2.dp[i][ctt])%=P;//è·¯å¾„ç±»*è·¯å¾„æ¡,cttæ˜¯é‡ç‚¹ 
		(ans*=26)%=P;//ç»ˆç‚¹çš„è‡ªç¯
		for(int i=1; i&lt;=26; ++i) {
			for(int j=1; j&lt;=n; ++j) {//æšä¸¾æœ€åæ˜¯å•¥
				if(mde[j]=='a'+i-1)//å¦‚æœè¿™ä¸ªå¯ä»¥åšæœ€å
					for(int k=0; k&lt;n; ++k)(ans+=g[k]*g2.dp[k][tr[j][j]])%=P;//å†åŠ ä¸Šåˆ°è¿™ä¸ªå•ä¸ªå­—ç¬¦ç‚¹å¯ä»¥çš„ 
			}
		}
	} else {
		for(int i=0; i&lt;n; ++i)(ans+=f[i]*g2.dp[i][ctt])%=P;
	}
	printf(&quot;%d&quot;,ans);
	return 0;
}


</code></pre>
]]></content>
    </entry>
</feed>